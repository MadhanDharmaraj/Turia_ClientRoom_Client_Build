(this["webpackJsonpvuexy-react-admin-dashboard"]=this["webpackJsonpvuexy-react-admin-dashboard"]||[]).push([[57],{1474:function(e,t,n){"use strict";n.r(t);var a=n(41),c=n(18),i=n(2),r=n(5),s=n(8),o=n(10),l=n(12),d=n(0),u=n(23),b=n(25),j=n(7),m=n.n(j),f=n(769),O=n(6),v=n(747),p=n.n(v),x=n(253),g=n(365),h=n(358),I=n(15),N=n(184),y=n(742),k=n(744),S=n(745),w=n(70),C=n(188),A=n(189),z=n(14),B=n(735),F=n(736),P=n(138),V=(n(746),n(481),n(737),n(743),n(13)),T=n(21),_=n(790),D=n(28),E=n.n(D),q=n(191),R=n(3),L=Object(V.b)(),G=Object(V.d)(),K=Object(V.a)(),M=function(e){var t,n=e.serviceModal,a=e.serviceIdCallBack,c=Object(d.useState)(!1),u=Object(l.a)(c,2),b=u[0],j=u[1],f=function(){return Object(R.jsx)(d.Fragment,{children:Object(R.jsx)(F.a,{})})},v={multiValue:function(e,t){return Object(o.a)(t),Object(s.a)(Object(s.a)({},e),{},{backgroundColor:"#7367f0"})}},p=Object(T.c)((function(e){return e.service})),x=Object(d.useState)(!1),g=Object(l.a)(x,2),h=g[0],I=g[1],w=Object(T.b)(),C=Object(d.useState)(!0),A=Object(l.a)(C,2),P=A[0],V=A[1],_=Object(d.useState)([]),D=Object(l.a)(_,2),E=D[0],M=D[1],U=Object(d.useState)([]),Y=Object(l.a)(U,2),J=Y[0],H=Y[1],Z=Object(d.useState)([]),Q=Object(l.a)(Z,2),W=Q[0],X=Q[1],$=Object(d.useState)([]),ee=Object(l.a)($,2),te=ee[0],ne=ee[1],ae=k.d().shape({createdBy:k.f().default(G),categoryId:k.f().nullable(),tat:k.c().default(0),categoryType:k.c().default(1),formslist:k.a().default([]),name:k.f().required("Please Enter Service Name"),organizationId:k.f().default(L),taxGroupId:k.f().nullable(),sellingPrice:k.f().nullable(),isTaxApplicable:k.b().default(!1),exemptionReasonId:k.f().nullable(),sacCode:k.f().nullable(),description:k.f().default("").nullable()}),ce=Object(y.f)({resolver:Object(S.a)(ae),defaultValues:ae.cast()}),ie=ce.handleSubmit,re=ce.control,se=ce.formState.errors,oe=ce.setValue,le=ce.setError;Object(d.useEffect)((function(){I(n)}),[n]),Object(d.useEffect)((function(){O.a.post("/taxgroups/dropdown").then((function(e){var t=e.data;M(t.taxgroups)})),O.a.post("/exemptionreasons/dropdown").then((function(e){var t=e.data;X(t.exemptionreasons)})),O.a.post("/serviceforms/dropdown").then((function(e){var t=e.data;H(t.serviceforms)}))}),[]),Object(d.useEffect)((function(){null!==p.Errors&&(j(!1),Object.keys(p.Errors).map((function(e){le(e,{type:"custom",message:p.Errors[e][0]})})))}),[p.Errors]);var de=function(){var e=Object(r.a)(Object(i.a)().mark((function e(t){var n,c;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.next=3,w(Object(q.a)(t));case 3:n=e.sent,(c=n.payload.id)&&(a(c),I(!1),j(!1));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ue=function(e){e.nontaxableflag?(V(!1),oe("isTaxApplicable",!1)):(V(!0),oe("exemptionReasonId",null),oe("isTaxApplicable",!0))},be=function(e){ne(e);var t=Array.isArray(e)?e.map((function(e){return e.id})):[];oe("formslist",t)},je=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:m()("form-label ".concat(n?"required":"")),for:t,children:e}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{id:t,name:t,control:re,render:function(e){var n=e.field;return Object(R.jsx)(z.K,Object(s.a)({invalid:se[t]&&!0},n))}}),se[t]&&Object(R.jsx)(z.I,{children:se[t].message})]})]})},me=function(e,t,n){var a,c=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:m()("form-label ".concat(c?"required":"")),for:t,children:e}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{control:re,name:t,id:t,render:function(e){var a=e.field,c=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)({inputRef:c,className:m()("react-select",{"is-invalid":se[t]})},a),{},{classNamePrefix:"select",options:n,value:n.find((function(e){return e.id===a.value})),onChange:function(e){a.onChange(e.id),"taxGroupId"===t&&ue(e)},getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id}}))}}),se[t]&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(a=se[t])||void 0===a?void 0:a.message})]})]})};return Object(R.jsx)(B.a,{blocking:b,loader:Object(R.jsx)(f,{}),children:Object(R.jsx)(z.Q,{isOpen:h,toggle:function(){return I(!h)},className:"modal-dialog-centered modal-dsc",children:Object(R.jsx)(z.R,{children:Object(R.jsxs)("form",{onSubmit:ie(de),children:[Object(R.jsxs)(z.l,{className:"invoice-preview-card",children:[Object(R.jsx)(z.p,{children:Object(R.jsx)(z.v,{children:" Add Service"})}),Object(R.jsx)(z.m,{className:"pb-0",children:Object(R.jsxs)(z.ib,{lg:12,sm:12,children:[Object(R.jsxs)(z.B,{lg:6,sm:12,className:"border border-start-0 border-top-0 border-bottom-0",children:[Object(R.jsx)(z.ib,{children:Object(R.jsx)(z.B,{md:"12",className:"mb-1",children:je("Service Name","name",!0)})}),Object(R.jsx)(z.ib,{children:Object(R.jsx)(z.B,{md:"12",className:"mb-1",children:je("Professional Fee","sellingPrice",!1)})}),K.isgstregistered&&Object(R.jsxs)(d.Fragment,{children:[Object(R.jsx)(z.ib,{children:Object(R.jsx)(z.B,{md:"12",className:"mb-1",children:me("Tax Rate","taxGroupId",E,!1)})}),!P&&Object(R.jsx)(z.ib,{children:Object(R.jsx)(z.B,{md:"12",className:"mb-1",children:me("Exemption Reason","exemptionReasonId",W,!1)})}),Object(R.jsx)(z.ib,{children:Object(R.jsx)(z.B,{md:"12",className:"mb-1",children:je("SAC Code","sacCode",!1)})})]})]}),Object(R.jsxs)(z.B,{lg:6,sm:12,children:[Object(R.jsxs)(z.ib,{className:"mb-2",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:m()("form-label"),for:"formslist",children:"Forms"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{control:re,name:"formslist",id:"formslist",render:function(e){var t=e.field,n=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)({inputRef:n,className:m()("react-select",{"is-invalid":se.formslist})},t),{},{classNamePrefix:"select",options:J,isMulti:!0,onChange:be,value:te,getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id},styles:v}))}}),se.formslist&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(t=se.formslist)||void 0===t?void 0:t.message})]})]}),Object(R.jsx)(z.ib,{children:Object(R.jsx)(z.B,{md:"12",className:"mb-1",children:je("Turn Around Time(TAT)","tat",!1)})}),Object(R.jsx)(z.ib,{children:Object(R.jsx)(z.B,{md:"12",className:"mb-1",children:Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label",for:"description",children:"Description"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{id:"description",name:"description",control:re,render:function(e){var t=e.field;return Object(R.jsx)(z.K,Object(s.a)({type:"textarea",invalid:se.description&&!0},t))}}),se.description&&Object(R.jsx)(z.I,{children:se.description.message})]})]})})})]})]})})]}),Object(R.jsx)(z.l,{children:Object(R.jsx)(z.m,{children:Object(R.jsxs)("div",{className:"modal-footer border-0",children:[Object(R.jsx)(z.i,{color:"warning",outline:!0,onClick:function(){I(!1)},children:"Cancel"}),Object(R.jsx)(z.i,{color:"primary",type:"submit",children:"Save"})]})})})]})})})})},U=["data"],Y=Object(V.b)(),J=Object(V.a)(),H=Object(V.d)(),Z=function(){var e,t,n,j,v,V,D,q=Object(d.useState)(!1),L=Object(l.a)(q,2),G=L[0],K=L[1],Z=function(){return Object(R.jsx)(d.Fragment,{children:Object(R.jsx)(F.a,{})})},Q={multiValue:function(e,t){return Object(o.a)(t),Object(s.a)(Object(s.a)({},e),{},{backgroundColor:"#7367f0"})}},W=Object(u.e)().search,X=new URLSearchParams(W),$=Object(u.f)(),ee=Object(d.useState)(E()().unix()),te=Object(l.a)(ee,2),ne=te[0],ae=te[1],ce=k.d().shape({createdBy:k.f().default(H),clientId:k.f().required("Please select a Client"),serviceId:k.f().required("Please select a Service"),forms:k.a(),assignee:k.a().min(1,"Please select Assignee"),reviewer:k.a(),clientAccessFlag:k.b().default(!1),organizationId:k.f().default(Y),taskStatus:k.c().default(1),invoiceId:k.f().default(0),startDate:k.f().required("Please Select Start Date").default(ne),endDate:k.f(),recurringFlag:k.b().default(!1),priority:k.f().nullable(),invoiceFlag:k.b().default(!0),invoiceItems:k.a().of(k.d().shape({serviceId:k.f().required("Please Select Service Item"),invoiceId:k.f(),sacCode:k.f(),price:k.f(),convertionAmount:k.f().default("0"),organizationId:k.f().default(Y),exemptioReasonId:k.f(),actualPrice:k.f().nullable(),taxGroupId:k.f().nullable(),subTotalAmount:k.f().nullable("Subtotal Should be Greater than 0"),isTaxApplicable:k.b().default(!0),taxes:k.f()})).when("invoiceFlag",{is:function(e){return!0===e},then:k.a().min(1,"Require Atleast one Item when Proposal For this Task.")})}),ie=Object(T.c)((function(e){return e.task})),re=Object(T.c)((function(e){return e.invoice})),se=Object(y.f)({resolver:Object(S.a)(ce),defaultValues:ce.cast()}),oe=se.handleSubmit,le=se.formState.errors,de=se.control,ue=se.setValue;Object(d.useEffect)((function(){X.get("clientId")&&ue("clientId",X.get("clientId")),X.get("serviceId")&&ue("serviceId",X.get("serviceId"))}),[X]);var be={image:"ui-attachment--image",pdf:"ui-attachment--pdf",xlsx:"ui-attachment--excel",xls:"ui-attachment--excel",docx:"ui-attachment--docx",doc:"ui-attachment--docx"},je=[{id:1,name:"Low"},{id:2,name:"Medium"},{id:3,name:"High"}],me=Object(d.useState)([]),fe=Object(l.a)(me,2),Oe=fe[0],ve=fe[1],pe=Object(d.useState)([]),xe=Object(l.a)(pe,2),ge=xe[0],he=xe[1],Ie=Object(T.b)(),Ne=Object(d.useState)([]),ye=Object(l.a)(Ne,2),ke=ye[0],Se=ye[1],we=Object(d.useState)([]),Ce=Object(l.a)(we,2),Ae=Ce[0],ze=Ce[1],Be=Object(d.useState)([]),Fe=Object(l.a)(Be,2),Pe=Fe[0],Ve=Fe[1],Te=Object(d.useState)([]),_e=Object(l.a)(Te,2),De=_e[0],Ee=_e[1],qe=Object(d.useState)([]),Re=Object(l.a)(qe,2),Le=Re[0],Ge=Re[1],Ke=Object(d.useState)(!0),Me=Object(l.a)(Ke,2),Ue=Me[0],Ye=Me[1],Je=Object(d.useState)([]),He=Object(l.a)(Je,2),Ze=He[0],Qe=He[1],We=Object(d.useState)([]),Xe=Object(l.a)(We,2),$e=Xe[0],et=Xe[1],tt=Object(d.useState)({}),nt=Object(l.a)(tt,2),at=nt[0],ct=nt[1],it=Object(d.useState)({}),rt=Object(l.a)(it,2),st=rt[0],ot=rt[1],lt=Object(d.useState)([]),dt=Object(l.a)(lt,2),ut=dt[0],bt=dt[1],jt=Object(d.useState)([]),mt=Object(l.a)(jt,2),ft=mt[0],Ot=mt[1],vt=Object(d.useState)(0),pt=Object(l.a)(vt,2),xt=pt[0],gt=pt[1],ht=Object(d.useState)(0),It=Object(l.a)(ht,2),Nt=It[0],yt=It[1],kt=Object(d.useState)(""),St=Object(l.a)(kt,2),wt=St[0],Ct=St[1],At=Object(d.useState)(0),zt=Object(l.a)(At,2),Bt=zt[0],Ft=zt[1],Pt=Object(y.e)({name:"invoiceItems",keyName:"rowid",control:de}),Vt=Pt.fields,Tt=Pt.append,_t=Pt.remove,Dt=Object(d.useState)(null),Et=Object(l.a)(Dt,2),qt=Et[0],Rt=Et[1],Lt=Object(d.useState)([]),Gt=Object(l.a)(Lt,2),Kt=Gt[0],Mt=Gt[1],Ut=Object(d.useState)(0),Yt=Object(l.a)(Ut,2),Jt=Yt[0],Ht=Yt[1],Zt=Object(d.useState)([]),Qt=Object(l.a)(Zt,2),Wt=Qt[0],Xt=Qt[1],$t=Object(d.useContext)(w.a),en=function(){var e=Object(r.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={taskId:ie.taskId,organizationId:Y,attachmentIds:Wt,createdBy:H},e.next=3,O.a.post("/google/movetaskfiles",t).then((function(){}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(d.useEffect)(Object(r.a)(Object(i.a)().mark((function e(){var t,n,a,c,r,o,l;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===ie.taskId){e.next=26;break}return t=$e.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{taskId:ie.taskId})})),e.next=4,Ie(Object(C.c)({rows:t}));case 4:return n=ke.find((function(e){return e.id===de._formValues.clientId})),a=Ae.find((function(e){return e.id===de._formValues.serviceId})),e.next=8,Ie(Object(C.r)({rows:t,message:"New Task created for ".concat(null===a||void 0===a?void 0:a.name," to ").concat(n.name),userId:H}));case 8:if(!(""!==wt||Wt.length>0)){e.next=12;break}return c={comment:wt,taskId:ie.taskId,createdBy:H,organizationId:Y,attachmentIds:Wt,isDefault:!0},e.next=12,Ie(Object(C.a)(c));case 12:return r={taskId:ie.taskId,serviceId:de._formValues.serviceId,organizationId:Y,createdBy:H},e.next=15,Ie(Object(C.f)(r));case 15:if(!(Wt.length>0)){e.next=18;break}return e.next=18,en();case 18:if(!Ue||!$t.can("write","invoice")){e.next=24;break}return o=Object(s.a)(Object(s.a)({},st),{},{calculateTaxes:JSON.stringify(ut),totalTaxAmount:String(Bt),dueAmount:String(xt),totalAmount:String(xt),subTotalAmount:String(Nt)}),e.next=22,Ie(Object(A.a)(o));case 22:e.next=26;break;case 24:l=ie.taskId,$("/task/view/".concat(l));case 26:case"end":return e.stop()}}),e)}))),[ie.taskId]),Object(d.useEffect)(Object(r.a)(Object(i.a)().mark((function e(){var t,n,a,c,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ue){e.next=16;break}if(null===re.invoiceId){e.next=16;break}return t=ft.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{invoiceId:re.invoiceId})})),e.next=5,Ie(Object(A.b)(t));case 5:return n=re.invoiceId,a=ie.taskId,e.next=9,Ie(Object(C.u)({updatedBy:H,id:a,invoiceId:n}));case 9:return c=$e.map((function(e){return e.userId})),r={users:c,organizationId:Y,invoiceId:n},e.next=13,Ie(Object(A.c)(r));case 13:return e.next=15,Ie(Object(A.l)(null));case 15:$("/task/view/".concat(a));case 16:case"end":return e.stop()}}),e)}))),[re.invoiceId]);var tn=function(e,t){return{organizationId:Y,userId:e,type:t,createdBy:H}},nn=function(){var e=Object(r.a)(Object(i.a)().mark((function e(t){var n,a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K(!0),n=t.invoiceItems,Ot((function(e){return[].concat(Object(c.a)(e),Object(c.a)(n))})),a=[],t.assignee.forEach((function(e){a.push(tn(e,1))})),void 0!==t.reviewer&&t.reviewer.forEach((function(e){a.push(tn(e,2))})),J.taskcreateapproval&&(t.taskStatus=8),et(a),delete t.invoiceItems,delete t.assignee,delete t.reviewer,e.next=13,Ie(Object(C.b)(t));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),an=function(){O.a.post("/services/dropdown",{status:1}).then((function(e){var t=[{id:"add-new",name:"Add New Service",type:"button",color:"flat-success"}].concat(Object(c.a)(e.data.services));ze(t)}))},cn=function(){var e=Object(r.a)(Object(i.a)().mark((function e(t){var n;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ie(Object(C.m)(t));case 2:n=e.sent,ct(n.payload);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(d.useEffect)((function(){if(X.get("clientId")&&0===Object.keys(at).length){var e=X.get("clientId");ue("clientId",e),cn(e)}X.get("serviceId")&&ue("serviceId",X.get("serviceId"))}),[X]);var rn=function(){var e=Object(r.a)(Object(i.a)().mark((function e(){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O.a.post("/organizationusers/dropdown").then((function(e){var t=e.data;he(t.organizationusers),ve(t.organizationusers),Ve(t.organizationusers)})).catch((function(e){console.log(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),sn={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){Ht(Math.round(100*e.loaded/e.total))}},on=function(e){var t=new FormData;K(!0),e.forEach((function(e,n){t.append("files[".concat(n,"]"),e)})),t.append("organizationId",Y),t.append("createdBy",H),O.a.post("/google/taskfiles",t,sn).then((function(e){Xt([].concat(Object(c.a)(Wt),Object(c.a)(e.data.attachment_ids))),K(!1)})).catch((function(e){console.log(e)}))},ln=Object(f.a)({multiple:!0,onDrop:function(){var e=Object(r.a)(Object(i.a)().mark((function e(t,n){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],t.forEach((function(e){e.extension=e.name.split(".").pop(),a.push(e)})),!n.length){e.next=6;break}toast.error("You can only upload image Files!."),e.next=9;break;case 6:return e.next=8,on(a);case 8:Mt([].concat(Object(c.a)(Kt),a));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),dn=ln.getRootProps,un=ln.getInputProps,bn=function(e){var t={type:e};O.a.post("/taxvalues/list",t).then((function(e){var t=e.data;Qe(t.taxvalues)}))},jn=function(){Tt({invoiceId:0,organizationId:Y,serviceId:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",sacCode:"",actualPrice:0,taxGroupId:"",subTotalAmount:0,taxPrice:0,description:"",isTaxApplicable:!0})};Object(d.useEffect)(Object(r.a)(Object(i.a)().mark((function e(){var t,n,a,c,r,s;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Object.keys(at).length>0)){e.next=51;break}if((t={}).bankAccountBankName=null===(n=qt)||void 0===n?void 0:n.bankName,t.bankAccountBranchName=null===n||void 0===n?void 0:n.branchAddress,t.bankAccountHolderName=null===n||void 0===n?void 0:n.accountHolderName,t.bankAccountId=null===n||void 0===n?void 0:n.id,t.bankAccountIfscCode=null===n||void 0===n?void 0:n.ifscCode,t.bankAccountNumber=null===n||void 0===n?void 0:n.accountNumber,t.isgstregistered=(null===J||void 0===J?void 0:J.isgstregistered)&&"IN"===at.billingaddresscountriesshorcode,t.billingAddressCity=at.billingaddresscity,t.billingAddressLine1=at.billingaddressline1,t.billingAddressLine2=at.billingaddressline2||"",t.billingAddressState=at.billingaddressstatesname||"",t.billingAddressZipCode=at.billingaddresszip,t.billingCurrencyId=at.currencyid||J.currencyid,t.billingCurrencySymbol=at.currenciessymbol,t.billingCurrencyShortName=at.currenciescode,t.billingCurrencyName=at.currenciesname,t.contactEmail=at.email,t.gstin=at.gstin,t.isRcmApplicable=!1,t.contactName=at.name,t.placeOfSupplyId=at.placeofsupplyid,t.contactId=at.id,t.organizationAddressLine1=J.addressline1,t.organizationAddressLine2=J.addressline2,t.organizationCity=J.organizationcity,t.organizationState=J.statename,t.organizationZipCode=J.pinzipcode,t.organizationName=J.name,t.organizationImageUrl=J.organizationimageid,t.organizationStateCode=J.stateshortname,t.organizationGstin=J.gstin,t.createdBy=H,t.invoiceDate=E()().startOf("day").valueOf(),t.organizationId=Y,t.note="",t.paymentStatus=5,t.status=4,t.paymentDue=E()().startOf("day").valueOf(),t.convertionAmount="0",_t(),jn(),null!==J&&void 0!==J&&J.isgstregistered&&"IN"===at.billingaddresscountriesshorcode?(a=1,J.stateid===at.placeofsupplyid&&(a=2),bn(a)):(t.billingAddressStateOthers=null!==(c=at.billingaddressstateothers)&&void 0!==c?c:"",t.placeOfSupplyOthers=null!==(r=at.placeofsupplyothers)&&void 0!==r?r:""),"IN"===at.billingaddresscountriesshorcode){e.next=50;break}return e.next=48,Object(P.a)(at.currenciescode.toUpperCase(),J.currencycode);case 48:s=e.sent,t.convertionAmount=null!==s&&void 0!==s?s:"0";case 50:ot(t);case 51:case"end":return e.stop()}}),e)}))),[at]);var mn=function(){var e=de._formValues.invoiceItems,t=0,n=0,a=0;e.forEach((function(e){t=parseFloat(e.subTotalAmount)+parseFloat(t),n=parseFloat(e.price)+parseFloat(n),a=parseFloat(a)+parseFloat(e.taxPrice)})),gt(t),yt(n),Ft(a),function(){var e;e=de._formValues.invoiceItems.map((function(e){return Object(_.b)(e.taxes)})).flat().reduce((function(e,t){if(void 0!==t){var n=e.find((function(e){return t.taxName===e.taxName}));n?n.taxAmount=parseFloat(n.taxAmount)+parseFloat(t.taxAmount):e.push(Object.assign({},t))}return e}),[]),bt(e)}()},fn=function(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=de._formValues.invoiceItems[e]||{};if(void 0===o.serviceId||""===o.serviceId)return!1;var l=Ae.find((function(e){return e.id===o.serviceId}));ue("invoiceItems[".concat(e,"].serviceId"),o.serviceId),s?(ue("invoiceItems[".concat(e,"].sacCode"),l.saccode),t=l.sellingprice||0,n=l.taxgroupid,ue("invoiceItems[".concat(e,"].actualPrice"),t),ue("invoiceItems[".concat(e,"].price"),String(l.sellingprice)||0),ue("invoiceItems[".concat(e,"].taxGroupId"),n),ue("invoiceItems[".concat(e,"].description"),l.description),ue("invoiceItems[".concat(e,"].exemptionReasonId"),l.exemptionreasonid||"")):(ue("invoiceItems[".concat(e,"].sacCode"),i?o.sacCode:l.saccode),t=c?o.price:l.sellingprice||0,n=r?o.taxGroupId:l.taxgroupid,ue("invoiceItems[".concat(e,"].price"),t),ue("invoiceItems[".concat(e,"].actualPrice"),String(l.sellingprice)||0),ue("invoiceItems[".concat(e,"].taxGroupId"),n),ue("invoiceItems[".concat(e,"].description"),a?o.description:l.description),ue("invoiceItems[".concat(e,"].exemptionReasonId"),l.exemptionreasonid||""));var d=0,u=[],b=Le.find((function(e){return e.id===n})),j=void 0!==b?!b.nontaxableflag:l.istaxapplicable||!1;j=j&&(null===J||void 0===J?void 0:J.isgstregistered)&&(null===J||void 0===J?void 0:J.isgstregistered)&&"IN"===at.billingaddresscountriesshorcode,ue("invoiceItems[".concat(e,"].isTaxApplicable"),j),j&&void 0!==b&&Ze.forEach((function(e){if(e.taxid===n){var a;a=Object(_.a)(t,e.percentage,2),d=parseFloat(d)+parseFloat(a);var c={};c.taxName="".concat(e.name," (").concat(e.percentage,"%)"),c.taxId=parseInt(e.id),c.taxNameValue=e.name,c.taxPercentage=String(e.percentage),c.taxAmount=String(a),u.push(c)}})),ue("invoiceItems[".concat(e,"].subTotalAmount"),parseFloat(parseFloat(d||0)+parseFloat(t||0)).toFixed(2)),ue("invoiceItems[".concat(e,"].taxPrice"),parseFloat(d).toFixed(2)),ue("invoiceItems[".concat(e,"].taxes"),JSON.stringify(u)),ue("invoiceItems[".concat(e,"].createdBy"),H),mn()},On=Kt.map((function(e,t){return Object(R.jsxs)(z.B,{md:4,className:"d-flex align-items-center justify-content-between ui-attachment ".concat(be[e.extension]||be.image),children:[Object(R.jsx)("div",{className:"file-details d-flex align-items-center",children:Object(R.jsx)("div",{children:Object(R.jsx)("p",{className:"file-name mb-0 text-overflow-ellipsis",children:e.name.split(".")[0].length>15?"".concat(e.name.split(".")[0].substr(0,15)):e.name})})}),Object(R.jsx)(x.a,{size:14,className:"cursor-pointer",onClick:function(){return function(e,t){var n=Kt.filter((function(t){return t.name!==e.name}));Xt(Object(c.a)(Wt.splice(t,1))),Mt(n)}(e,t)}})]},"".concat(e.name,"-").concat(t))}));Object(d.useEffect)((function(){O.a.post("/clients/dropdown",{status:1}).then((function(e){var t=e.data;Se(t.clients)})),an(),O.a.post("/taxgroups/dropdown").then((function(e){var t=e.data;Ge(t.taxgroups)})),O.a.post("/transactionaccounts/defaultaccount").then((function(e){Rt(e.data.transactionaccount)})).catch((function(e){console.log(e)})),rn(),O.a.post("/exemptionreasons/dropdown").then((function(e){var t=e.data;Ee(t.exemptionreasons)})),jn()}),[]);var vn=function(e){var t,n=Array.isArray(e)?e.map((function(e){return e.id})):[];t=n.length>0?Pe.filter((function(e){var t=e.id;return!n.some((function(e){return e===t}))})):Pe,he(t),ue("assignee",n)},pn=function(e){var t,n=Array.isArray(e)?e.map((function(e){return e.id})):[];t=n.length>0?Pe.filter((function(e){var t=e.id;return!n.some((function(e){return e===t}))})):Pe,ve(t),ue("reviewer",n)},xn=Object(d.useState)(!1),gn=Object(l.a)(xn,2),hn=gn[0],In=gn[1],Nn=function(e){var t=e.data,n=Object(a.a)(e,U);return"button"===t.type?Object(R.jsxs)(z.i,{className:"text-start rounded-0 px-50",color:t.color,block:!0,onClick:function(){return In(!0)},children:[Object(R.jsx)(g.a,{className:"font-medium-1 me-50"}),Object(R.jsx)("span",{className:"align-middle",children:t.name})]}):Object(R.jsxs)(I.q.Option,Object(s.a)(Object(s.a)({},n),{},{children:[" ",t.name," "]}))},yn=Object(d.useState)(0),kn=Object(l.a)(yn,2),Sn=kn[0],wn=kn[1],Cn=function(){var e=Object(r.a)(Object(i.a)().mark((function e(t){var n,a,c,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:a=Ae.find((function(e){return e.id===t})),ue("forms",null!==(n=null===a||void 0===a?void 0:a.formslist)&&void 0!==n?n:[]),c=parseInt((null===a||void 0===a?void 0:a.tat)||0),wn(c),r=E()(1e3*ne,"x").add(c,"days").valueOf(),ue("endDate",String(r/1e3)),0===de._formValues.invoiceItems.length&&jn(t),ue("invoiceItems[0].serviceId",t),fn(0,!1,!1,!1,!1,!0);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),An=function(){var e=Object(r.a)(Object(i.a)().mark((function e(t){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t){e.next=6;break}return e.next=3,an();case 3:ue("serviceId",t),e.next=7;break;case 6:In(!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(R.jsxs)(B.a,{blocking:G,loader:Object(R.jsx)(Z,{}),children:[hn&&Object(R.jsx)(M,{serviceModal:hn,serviceIdCallBack:An}),Object(R.jsxs)("form",{onSubmit:oe(nn),children:[Object(R.jsxs)(z.l,{className:"invoice-preview-card",children:[Object.keys(le).map((function(e,t){var n;return Object(R.jsxs)(z.I,{children:[" ",null===(n=le[e])||void 0===n?void 0:n.message]},t)})),Object(R.jsx)(z.p,{children:"Add Task"}),Object(R.jsx)(z.m,{className:"pb-2 px-2",children:Object(R.jsxs)(z.ib,{children:[Object(R.jsxs)("div",{className:"col-lg-6 col-sm-12",children:[Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label required",for:"clientId",children:"Client"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{control:de,name:"clientId",id:"clientId",render:function(e){var t=e.field,n=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)(Object(s.a)({},t),{},{inputRef:n,className:m()("react-select",{"is-invalid":le.clientId})},t),{},{classNamePrefix:"select",options:ke,value:ke.find((function(e){return e.id===t.value})),onChange:function(e){t.onChange(e.id),cn(e.id)},getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id}}))}}),le.clientId&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(e=le.clientId)||void 0===e?void 0:e.message})]})]}),Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label required",for:"serviceId",children:"Service"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{control:de,name:"serviceId",id:"serviceId",render:function(e){var t=e.field,n=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)(Object(s.a)({},t),{},{inputRef:n,className:m()("react-select",{"is-invalid":le.serviceId})},t),{},{classNamePrefix:"select",components:{Option:Nn},options:Ae,value:Ae.find((function(e){return e.id===t.value})),onChange:function(e){return Cn(e.id),t.onChange(e.id)},getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id}}))}}),le.serviceId&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(t=le.serviceId)||void 0===t?void 0:t.message})]})]}),Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label",for:"description",children:"Description"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{id:"description",name:"description",control:de,render:function(e){var t=e.field;return Object(R.jsx)(z.K,Object(s.a)({type:"textarea",onInput:function(e){Ct(e.target.value)},invalid:le.description&&!0},t))}}),le.description&&Object(R.jsx)(z.I,{children:le.description.message})]})]}),Object(R.jsx)(z.ib,{className:"my-2",children:Object(R.jsx)(z.B,{children:Object(R.jsxs)("div",{className:"d-lg-flex",children:[Object(R.jsx)("input",Object(s.a)({},un())),Object(R.jsxs)(z.i,Object(s.a)(Object(s.a)({type:"button",color:"primary",size:"sm"},dn({})),{},{children:[Object(R.jsx)(h.a,{size:14,className:""})," Add Attachment"]})),Jt>0&&Object(R.jsx)(z.hb,{className:"mt-md-50",color:Jt<100?"primary":"success",value:Jt})]})})}),Object(R.jsx)(z.ib,{children:Object(R.jsx)(z.ib,{className:"d-flex p-1",children:On})})]}),Object(R.jsxs)("div",{className:"col-lg-6 col-sm-12",children:[Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label required",for:"assignee",children:"Assigned To"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{control:de,name:"assignee",id:"assignee",render:function(e){var t=e.field,n=e.value,a=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)({inputRef:a,className:m()("react-select",{"is-invalid":le.assignee})},t),{},{classNamePrefix:"select",options:Oe,isMulti:!0,value:n,onChange:vn,getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id},styles:Q}))}}),le.assignee&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(n=le.assignee)||void 0===n?void 0:n.message})]})]}),Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label",for:"reviewer",children:"Reviewer"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{control:de,name:"reviewer",id:"reviewer",render:function(e){var t=e.field,n=e.value,a=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)({inputRef:a,className:m()("react-select",{"is-invalid":le.reviewer})},t),{},{classNamePrefix:"select",options:ge,isMulti:!0,value:n,onChange:pn,getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id},styles:Q}))}}),le.reviewer&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(j=le.reviewer)||void 0===j?void 0:j.message})]})]}),Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label required",for:"startDate",children:"Start Date"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{name:"startDate",control:de,rules:{required:!0},options:{dateFormat:"d-m-Y"},render:function(e){var t=e.field;return Object(R.jsx)(p.a,{value:t.value,onChange:function(e,n){t.onChange(n),function(e){ae(e);var t=E()(1e3*e,"x").add(Sn,"days").valueOf();ue("endDate",String(t/1e3))}(n)},options:{altInput:!0,altFormat:"F j, Y",dateFormat:"U"},className:m()("due-date-picker",{"flatpickr-input is-invalid":le.startDate})})}}),le.startDate&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(v=le.startDate)||void 0===v?void 0:v.message})]})]}),Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label",for:"endDate",children:"End Date"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{name:"endDate",control:de,rules:{required:!0},options:{dateFormat:"d-m-Y"},render:function(e){var t=e.field;return Object(R.jsx)(p.a,{value:t.value,onChange:function(e,n){t.onChange(n)},options:{altInput:!0,altFormat:"F j, Y",dateFormat:"U"},className:m()("due-date-picker",{"flatpickr-input is-invalid":le.endDate})})}}),le.endDate&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(V=le.endDate)||void 0===V?void 0:V.message})]})]}),Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label",for:"priority",children:"Priority"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{control:de,name:"priority",id:"priority",render:function(e){var t=e.field,n=e.value,a=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)(Object(s.a)({},t),{},{inputRef:a,className:m()("react-select",{"is-invalid":le.priority})},t),{},{classNamePrefix:"select",options:je,value:je.find((function(e){return e.id===n})),onChange:function(e){return t.onChange(e.id)},getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id}}))}}),le.priority&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(D=le.priority)||void 0===D?void 0:D.message})]})]})]})]})}),Object(R.jsxs)(w.b,{I:"write",a:"invoice",children:[Object(R.jsx)("hr",{className:"invoice-spacing"}),Object(R.jsx)(z.ib,{className:"px-1 pb-2",children:Object(R.jsxs)("div",{className:"form-check form-check-primary mx-2",children:[Object(R.jsx)(y.a,{control:de,name:"invoiceFlag",rules:{required:!0},render:function(e){var t=e.field;return Object(R.jsx)(z.K,Object(s.a)(Object(s.a)({className:"form-check-input",type:"checkbox",id:"invoice_flag"},t),{},{onChange:function(e){t.onChange(e),function(){if(Ye(!Ue),ue("invoiceFlag",!Ue),Ue)_t();else if(0===de._formValues.invoiceItems.length){var e=de._formValues.serviceId;jn(e),ue("invoiceItems[0].serviceId",e),fn(0,!1,!1,!1,!1,!0)}}()},defaultChecked:Ue}))}}),Object(R.jsx)(z.N,{className:"form-check-label",for:"invoice_flag",children:"Create Profoma Invoice for this Task"})]})}),Ue&&Object(R.jsxs)(z.m,{className:"invoice-padding invoice-product-details",children:[Vt.map((function(e,t){var n,a,c,i,r,o,l,d,u,b,j,f,O,v,p,g;return Object(R.jsx)("div",{className:"repeater-wrapper",children:Object(R.jsx)(z.ib,{children:Object(R.jsxs)(z.B,{className:"d-lg-flex product-details-border position-relative pe-0",sm:"12",children:[Object(R.jsxs)(z.ib,{className:"w-100 pe-lg-0 pe-1 py-2",children:[Object(R.jsxs)(z.B,{className:"mb-lg-0 mb-2 mt-lg-0 mt-2 col-lg-4 col-sm-12",children:[Object(R.jsx)(z.u,{className:"col-title mb-md-50 mb-0",children:"Item"}),Object(R.jsx)(y.a,{control:de,name:"invoiceItems[".concat(t,"].serviceId"),rules:{required:!0},render:function(e){var n,a,c=e.field,i=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)({},c),{},{inputRef:i,className:m()("react-select",{"is-invalid":null===(n=le.invoiceItems)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.serviceId}),classNamePrefix:"select",options:Ae,value:Ae.find((function(e){return e.id===c.value})),onChange:function(e){c.onChange(e.id),fn(t,!1,!1,!1,!1,!0)},getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id}}))}}),(null===(n=le.invoiceItems)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.serviceId)&&Object(R.jsx)(z.I,{children:null===(c=le.invoiceItems)||void 0===c||null===(i=c[t])||void 0===i?void 0:i.serviceId.message}),Object(R.jsx)(y.a,{id:"invoiceItems_".concat(t,"_description"),name:"invoiceItems[".concat(t,"].description"),control:de,render:function(e){var n,a,c=e.field;return Object(R.jsx)(z.K,Object(s.a)({className:"mt-1",invalid:(null===(n=le.invoiceItems)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.description)&&!0,onInput:function(e){c.onChange(e),fn(t,!0,!1,!1,!1,!1)}},c))}})]}),J.isgstregistered&&Object(R.jsxs)(z.B,{className:"my-lg-0 my-2 col-lg-2 col-sm-12",children:[Object(R.jsx)(z.u,{className:"col-title mb-md-2 mb-0",children:"SAC Code"}),Object(R.jsx)(y.a,{id:"invoiceItems_".concat(t,"_sacCode"),name:"invoiceItems[".concat(t,"].sacCode"),control:de,render:function(e){var n,a,c=e.field;return Object(R.jsx)(z.K,Object(s.a)({type:"text",invalid:(null===(n=le.invoiceItems)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.sacCode)&&!0,onInput:function(e){c.onChange(e),fn(t,!1,!0,!0,!1,!1)}},c))}}),(null===(r=le.invoiceItems)||void 0===r||null===(o=r[t])||void 0===o?void 0:o.sacCode)&&Object(R.jsx)(z.I,{children:null===(l=le.invoiceItems)||void 0===l||null===(d=l[t])||void 0===d?void 0:d.sacCode.message})]}),Object(R.jsxs)(z.B,{className:"my-lg-0 my-2",lg:"2",sm:"12",children:[Object(R.jsx)(z.u,{className:"col-title mb-md-2 mb-0",children:"Price"}),Object(R.jsx)(y.a,{id:"invoiceItems_".concat(t,"_price"),name:"invoiceItems[".concat(t,"].price"),control:de,render:function(e){var n,a,c=e.field;return Object(R.jsx)(z.K,Object(s.a)(Object(s.a)({type:"number",id:"input_invoiceItems_".concat(t,"_price"),onInput:function(e){c.onChange(e),fn(t,!1,!0,!1,!1,!1)}},c),{},{invalid:(null===(n=le.invoiceItems)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.price)&&!0}))}}),(null===(u=le.invoiceItems)||void 0===u||null===(b=u[t])||void 0===b?void 0:b.price)&&Object(R.jsx)(z.I,{children:null===(j=le.invoiceItems)||void 0===j||null===(f=j[t])||void 0===f?void 0:f.price.message})]}),(null===st||void 0===st?void 0:st.isgstregistered)&&Object(R.jsxs)(z.B,{className:"my-lg-0 mt-2",lg:"2",sm:"12",children:[Object(R.jsx)(z.u,{className:"col-title mb-md-50 mb-0",children:"Tax Rate"}),Object(R.jsx)(y.a,{control:de,name:"invoiceItems[".concat(t,"].taxGroupId"),rules:{required:!0},render:function(e){var n,a,c=e.field,i=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)({},c),{},{inputRef:i,className:m()("react-select",{"is-invalid":null===(n=le.invoiceItems)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.taxGroupId}),classNamePrefix:"select",options:Le,value:Le.find((function(e){return e.id===c.value})),onChange:function(e){c.onChange(e.id),fn(t,!1,!0,!1,!0,!1)},getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id}}))}}),(null===(O=le.invoiceItems)||void 0===O||null===(v=O[t])||void 0===v?void 0:v.taxGroupId)&&Object(R.jsx)(z.I,{children:null===(p=le.invoiceItems)||void 0===p||null===(g=p[t])||void 0===g?void 0:g.taxGroupId.message}),!e.isTaxApplicable&&Object(R.jsx)(y.a,{control:de,name:"invoiceItems[".concat(t,"].exemptionReasonId"),rules:{required:!0},render:function(e){var n,a,c=e.field,i=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)({},c),{},{inputRef:i,className:m()("react-select mt-1",{"is-invalid":null===(n=le.invoiceItems)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.taxGroupId}),classNamePrefix:"select",options:De,value:De.find((function(e){return e.id===c.value})),onChange:function(e){c.onChange(e.id)},getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id}}))}})]}),Object(R.jsxs)(z.B,{className:"my-lg-0 mt-2",lg:"1",sm:"12",children:[Object(R.jsx)(z.u,{className:"col-title mb-md-50 mb-0",children:"Amount"}),de._formValues.invoiceItems[t].subTotalAmount]})]}),Object(R.jsx)("div",{className:"d-lg-flex justify-content-center border-start invoice-product-actions py-50 px-25",children:Object(R.jsx)(x.a,{size:18,className:"cursor-pointer",onClick:function(){_t(t),mn()}})})]})})},e.rowid)})),Object(R.jsx)(z.ib,{className:"mt-1",children:Object(R.jsx)(z.B,{sm:"12",className:"px-0",children:Object(R.jsxs)(z.i,{color:"primary",size:"sm",className:"btn-add-new",onClick:function(){return jn()},children:[Object(R.jsx)(g.a,{size:14,className:"me-25"})," ",Object(R.jsx)("span",{className:"align-middle",children:"Add Item"})]})})})]})]})]}),Object(R.jsx)(z.l,{children:Object(R.jsx)(z.m,{children:Object(R.jsxs)("div",{className:"modal-footer border-0",children:[Object(R.jsx)(z.i,{className:"add-new-user",outline:!0,color:"warning",tag:b.b,to:"/task/list",children:"Cancel"}),Object(R.jsx)(z.i,{color:"primary",type:"submit",children:"Save"})]})})})]})]})},Q=n(364),W=n(386),X=Object(V.b)(),$=Object(V.a)(),ee=Object(V.d)(),te=function(e){var t=e.mainInd,n=e.refreshTax,a=e.taxGroupOptions,c=e.itemAmount,i=e.parentaxCallback,r=e.control,o=Object(y.e)({control:r,name:"invoiceItems[".concat(t,"].taxes")}),l=o.fields,u=o.append,b=o.remove,j=function(){u({taxGroupId:"",taxAmount:0,taxName:""})};Object(d.useEffect)((function(){var e;0===(null===(e=r._formValues.invoiceItems[t])||void 0===e?void 0:e.taxes.length)&&j()}),[]);var f=function(e,n){var r=a.find((function(t){return t.id===e})),s=Object(_.a)(c,r.percentage,2);i({taxAmount:s,taxName:r.name,taxGroupId:r.id},t,n)};return Object(d.useEffect)((function(){n&&r._formValues.invoiceItems[t].taxes.forEach((function(e,t){""!==e.taxGroupId&&f(e.taxGroupId,t)}))}),[n]),l.map((function(e,n){var c;return Object(R.jsxs)(z.ib,{className:"d-flex align-items-center justify-content-between pe-lg-0 pe-1 py-50",md:12,children:[Object(R.jsx)(z.B,{md:6}),Object(R.jsx)(z.B,{md:1,className:"d-flex justify-content-end",children:n===l.length-1&&Object(R.jsx)(Q.a,{size:"16",className:"text-primary",onClick:function(){return j()}})}),Object(R.jsx)(z.B,{className:"my-lg-0 mt-2",lg:"3",sm:"12",children:Object(R.jsx)(y.a,{control:r,name:"taxes[".concat(n,"].taxGroupId"),rules:{required:!0},render:function(e){var t=e.field,c=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)({},t),{},{inputRef:c,className:m()("react-select"),classNamePrefix:"select",options:a,placeholder:"Select Tax Rate",value:a.find((function(e){return e.id===t.value})),onChange:function(e){t.onChange(e.id),f(e.id,n)},getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id}}))}})}),Object(R.jsx)(z.B,{className:"my-lg-0 mt-2",lg:"1",sm:"12",children:(null===(c=r._formValues.invoiceItems[t].taxes[n])||void 0===c?void 0:c.taxAmount)||0}),Object(R.jsx)(z.B,{className:"my-lg-0 mt-2",lg:"1",sm:"12",children:r._formValues.invoiceItems[t].taxes.length>1&&Object(R.jsx)("div",{className:"d-lg-flex justify-content-center border-start invoice-product-actions py-50 px-25",children:Object(R.jsx)(W.a,{size:16,onClick:function(){b(n)}})})})]},e.id)}))},ne=function(){var e,t,n,a,j,v,I,w=Object(d.useState)(!1),P=Object(l.a)(w,2),V=P[0],_=P[1],D=function(){return Object(R.jsx)(d.Fragment,{children:Object(R.jsx)(F.a,{})})},q={multiValue:function(e,t){return Object(o.a)(t),Object(s.a)(Object(s.a)({},e),{},{backgroundColor:"#7367f0"})}},L=Object(u.e)().search,G=new URLSearchParams(L),K=Object(u.f)(),M=Object(d.useState)(!1),U=(Object(l.a)(M,1)[0],Object(d.useState)("")),Y=Object(l.a)(U,2),J=Y[0],H=Y[1],Z=k.d().shape({createdBy:k.f().default(ee),clientId:k.f().required("Please select a Client"),serviceId:k.f().required("Please select a Service"),assignee:k.a().min(1,"Please select Assignee"),reviewer:k.a(),clientAccessFlag:k.b().default(!1),organizationId:k.f().default(X),taskStatus:k.c().default(1),invoiceId:k.f().default(0),startDate:k.f().required("Please Select Start Date"),endDate:k.f().required("Please Select End Date"),recurringFlag:k.b().default(!1),priority:k.f().required("Please select a Priority"),invoiceFlag:k.b().default(!0),invoiceItems:k.a().of(k.d().shape({serviceId:k.f().required("Please Select Service Item"),invoiceId:k.f(),price:k.f(),organizationId:k.f().default(X),actualPrice:k.f().nullable(),subTotalAmount:k.f().nullable("Subtotal Should be Greater than 0"),isTaxApplicable:k.b().default(!0),taxes:k.a().of(k.d().shape({taxGroupId:k.f().required("Pleace Select Tax"),taxAmount:k.f().required(1),taxName:k.f()}))})).when("invoiceFlag",{is:function(e){return!0===e},then:k.a().min(1,"Require Atleast one Item when Proposal For this Task.")})}),Q=Object(T.c)((function(e){return e.task})),ne=Object(T.c)((function(e){return e.invoice})),ae=Object(y.f)({resolver:Object(S.a)(Z),defaultValues:Z.cast()}),ce=ae.handleSubmit,ie=ae.formState.errors,re=ae.control,se=ae.setValue;Object(d.useEffect)((function(){G.get("clientId")&&se("clientId",G.get("clientId")),G.get("serviceId")&&se("serviceId",G.get("serviceId"))}),[G]);var oe={image:"ui-attachment--image",pdf:"ui-attachment--pdf",xlsx:"ui-attachment--excel",xls:"ui-attachment--excel",docx:"ui-attachment--docx",doc:"ui-attachment--docx"},le=[{id:1,name:"Low"},{id:2,name:"Medium"},{id:3,name:"High"}],de=Object(d.useState)([]),ue=Object(l.a)(de,2),be=ue[0],je=ue[1],me=Object(d.useState)([]),fe=Object(l.a)(me,2),Oe=fe[0],ve=fe[1],pe=Object(T.b)(),xe=Object(d.useState)([]),ge=Object(l.a)(xe,2),he=ge[0],Ie=ge[1],Ne=Object(d.useState)([]),ye=Object(l.a)(Ne,2),ke=ye[0],Se=ye[1],we=Object(d.useState)([]),Ce=Object(l.a)(we,2),Ae=Ce[0],ze=Ce[1],Be=Object(d.useState)([]),Fe=Object(l.a)(Be,2),Pe=Fe[0],Ve=Fe[1],Te=Object(d.useState)(!0),_e=Object(l.a)(Te,2),De=_e[0],Ee=_e[1],qe=Object(d.useState)([]),Re=Object(l.a)(qe,2),Le=Re[0],Ge=Re[1],Ke=Object(d.useState)({}),Me=Object(l.a)(Ke,2),Ue=Me[0],Ye=Me[1],Je=Object(d.useState)({}),He=Object(l.a)(Je,2),Ze=He[0],Qe=He[1],We=Object(d.useState)([]),Xe=Object(l.a)(We,2),$e=Xe[0],et=Xe[1],tt=Object(d.useState)([]),nt=Object(l.a)(tt,2),at=nt[0],ct=nt[1],it=Object(d.useState)(0),rt=Object(l.a)(it,2),st=rt[0],ot=rt[1],lt=Object(d.useState)(!1),dt=Object(l.a)(lt,2),ut=dt[0],bt=dt[1],jt=Object(d.useState)(0),mt=Object(l.a)(jt,2),ft=mt[0],Ot=mt[1],vt=Object(d.useState)(""),pt=Object(l.a)(vt,2),xt=pt[0],gt=pt[1],ht=Object(d.useState)(0),It=Object(l.a)(ht,2),Nt=It[0],yt=It[1],kt=Object(y.e)({name:"invoiceItems",keyName:"rowid",control:re}),St=kt.fields,wt=kt.append,Ct=kt.remove,At=Object(d.useState)([]),zt=Object(l.a)(At,2),Bt=zt[0],Ft=zt[1],Pt=Object(d.useState)(0),Vt=Object(l.a)(Pt,2),Tt=Vt[0],_t=Vt[1],Dt=Object(d.useState)([]),Et=Object(l.a)(Dt,2),qt=Et[0],Rt=Et[1],Lt=function(){var e=Object(r.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={taskId:Q.taskId,organizationId:X,attachmentIds:qt,createdBy:ee},e.next=3,O.a.post("/google/movetaskfiles",t).then((function(){}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(d.useEffect)(Object(r.a)(Object(i.a)().mark((function e(){var t,n,a,c,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===Q.taskId){e.next=22;break}return t=Le.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{taskId:Q.taskId})})),e.next=4,pe(Object(C.c)({rows:t}));case 4:if(!(""!==xt||qt.length>0)){e.next=8;break}return n={comment:xt,taskId:Q.taskId,createdBy:ee,organizationId:X,attachmentIds:qt,isDefault:!0},e.next=8,pe(Object(C.a)(n));case 8:return a={taskId:Q.taskId,serviceId:re._formValues.serviceId,organizationId:X,createdBy:ee},e.next=11,pe(Object(C.f)(a));case 11:if(!(qt.length>0)){e.next=14;break}return e.next=14,Lt();case 14:if(!De){e.next=20;break}return c=Object(s.a)(Object(s.a)({},Ze),{},{calculateTaxes:JSON.stringify($e),totalTaxAmount:String(Nt),dueAmount:String(st),totalAmount:String(st),subTotalAmount:String(ft)}),e.next=18,pe(Object(A.a)(c));case 18:e.next=22;break;case 20:r=Q.taskId,K("/task/view/".concat(r));case 22:case"end":return e.stop()}}),e)}))),[Q.taskId]),Object(d.useEffect)(Object(r.a)(Object(i.a)().mark((function e(){var t,n,a,c,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!De){e.next=16;break}if(null===ne.invoiceId){e.next=16;break}return t=at.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{invoiceId:ne.invoiceId})})),e.next=5,pe(Object(A.b)(t));case 5:return n=ne.invoiceId,a=Q.taskId,e.next=9,pe(Object(C.u)({updatedBy:ee,id:a,invoiceId:n}));case 9:return c=Le.map((function(e){return e.userId})),r={users:c,organizationId:X,invoiceId:n},e.next=13,pe(Object(A.c)(r));case 13:return e.next=15,pe(Object(A.l)(null));case 15:K("/task/view/".concat(a));case 16:case"end":return e.stop()}}),e)}))),[ne.invoiceId]);var Gt=function(e,t){return{organizationId:X,userId:e,type:t,createdBy:ee}},Kt=function(){var e=Object(r.a)(Object(i.a)().mark((function e(t){var n,a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _(!0),n=t.invoiceItems,ct((function(e){return[].concat(Object(c.a)(e),Object(c.a)(n))})),a=[],t.assignee.forEach((function(e){a.push(Gt(e,1))})),void 0!==t.reviewer&&t.reviewer.forEach((function(e){a.push(Gt(e,2))})),Ge(a),delete t.invoiceItems,delete t.assignee,delete t.reviewer,e.next=12,pe(Object(C.b)(t));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Mt=function(){var e=Object(r.a)(Object(i.a)().mark((function e(t){var n;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe(Object(C.m)(t));case 2:n=e.sent,Ye(n.payload);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ut=function(){var e=Object(r.a)(Object(i.a)().mark((function e(){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O.a.post("/organizationusers/dropdown").then((function(e){var t=e.data;ve(t.organizationusers),je(t.organizationusers),ze(t.organizationusers)})).catch((function(e){console.log(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Yt={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){_t(Math.round(100*e.loaded/e.total))}},Jt=function(e){var t=new FormData;e.forEach((function(e,n){t.append("files[".concat(n,"]"),e)})),t.append("organizationId",X),t.append("createdBy",ee),O.a.post("/google/taskfiles",t,Yt).then((function(e){Rt([].concat(Object(c.a)(qt),Object(c.a)(e.data.attachment_ids)))})).catch((function(e){console.log(e)}))},Ht=Object(f.a)({multiple:!0,onDrop:function(){var e=Object(r.a)(Object(i.a)().mark((function e(t,n){var a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],t.forEach((function(e){e.extension=e.name.split(".").pop(),a.push(e)})),!n.length){e.next=6;break}toast.error("You can only upload image Files!."),e.next=9;break;case 6:return e.next=8,Jt(a);case 8:Ft([].concat(Object(c.a)(Bt),a));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),Zt=Ht.getRootProps,Qt=Ht.getInputProps,Wt=function(){wt({invoiceId:0,organizationId:X,serviceId:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",taxes:[],actualPrice:0,subTotalAmount:0,taxPrice:0,description:"",isTaxApplicable:!0})};Object(d.useEffect)((function(){if(Object.keys(Ue).length>0){var e={};e.billingAddressCity=Ue.billingaddresscity,e.billingAddressLine1=Ue.billingaddressline1,e.billingAddressLine2=Ue.billingaddressline2||"",e.billingAddressState=Ue.billingaddressstatesname||"",e.billingAddressZipCode=Ue.billingaddresszip,e.billingCurrencyId=Ue.currencyid||$.currencyid,e.billingCurrencySymbol=Ue.currenciessymbol,e.billingCurrencyShortName=Ue.currenciescode,e.billingCurrencyName=Ue.currenciesname,e.bankAccountBankName="",e.bankAccountBranchName="",e.bankAccountHolderName="",e.bankAccountId="",e.bankAccountIfscCode="",e.bankAccountNumber="",e.contactEmail=Ue.email,e.gstin=Ue.gstin,e.isRcmApplicable=!1,e.contactName=Ue.name,e.placeOfSupplyId=Ue.placeofsupplyid,e.contactId=Ue.id,e.organizationAddressLine1=$.addressline1,e.organizationAddressLine2=$.addressline2,e.organizationCity=$.organizationcity,e.organizationState=$.statename||"",e.organizationZipCode=$.pinzipcode,e.organizationName=$.name,e.organizationImageUrl=$.organizationimageid||"",e.organizationStateOther=$.stateothers||"",e.organizationStateCode=$.stateothers,e.organizationGstin=$.gstin,e.createdBy=ee,e.invoiceDate=E()().startOf("day").valueOf(),e.organizationId=X,e.note="",e.paymentStatus=5,e.status=4,e.paymentDue=E()().startOf("day").valueOf(),Qe(e)}}),[Ue]);var Xt=function(){var e=re._formValues.invoiceItems,t=0,n=0,a=0;e.forEach((function(e){t=parseFloat(e.subTotalAmount)+parseFloat(t),n=parseFloat(e.price)+parseFloat(n),a=parseFloat(a)+parseFloat(e.taxPrice)})),ot(t),Ot(n),yt(a),function(){var e;e=re._formValues.invoiceItems.map((function(e){return e.taxes})).flat().reduce((function(e,t){if(void 0!==t){var n=e.find((function(e){return t.taxName===e.taxName}));n?n.taxAmount=parseFloat(n.taxAmount)+parseFloat(t.taxAmount):e.push(Object.assign({},t))}return e}),[]),et(e)}()},$t=function(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,d=re._formValues.invoiceItems[e];if(void 0===d.serviceId||""===d.serviceId)return!1;var u=ke.find((function(e){return e.id===d.serviceId}));se("invoiceItems[".concat(e,"].serviceId"),d.serviceId),s?(se("invoiceItems[".concat(e,"].sacCode"),u.saccode),t=u.sellingprice||0,n=u.taxgroupid,se("invoiceItems[".concat(e,"].actualPrice"),t),se("invoiceItems[".concat(e,"].price"),String(u.sellingprice)||0),se("invoiceItems[".concat(e,"].taxGroupId"),n),se("invoiceItems[".concat(e,"].description"),u.description)):(se("invoiceItems[".concat(e,"].sacCode"),i?d.sacCode:u.saccode),t=c?d.price:u.sellingprice||0,n=r?d.taxGroupId:u.taxgroupid,se("invoiceItems[".concat(e,"].price"),t),se("invoiceItems[".concat(e,"].actualPrice"),String(u.sellingprice)||0),se("invoiceItems[".concat(e,"].taxGroupId"),n),se("invoiceItems[".concat(e,"].description"),a?d.description:u.description));var b=0;if(Object.keys(o).length>0&&r){re._formValues.invoiceItems[e].taxes[l]=o;var j=re._formValues.invoiceItems[e].taxes;se("invoiceItems[".concat(e,"].taxes"),j)}re._formValues.invoiceItems[e].taxes.forEach((function(e){b+=e.taxAmount})),se("invoiceItems[".concat(e,"].isTaxApplicable"),!0),se("invoiceItems[".concat(e,"].subTotalAmount"),parseFloat(parseFloat(b||0)+parseFloat(t||0)).toFixed(2)),se("invoiceItems[".concat(e,"].taxPrice"),parseFloat(b).toFixed(2)),se("invoiceItems[".concat(e,"].createdBy"),ee),Xt()},en=function(e,t,n){e&&(bt(!1),$t(t,!0,!0,!0,!0,!1,e,n))},tn=Bt.map((function(e,t){return Object(R.jsxs)(z.B,{md:4,className:"d-flex align-items-center justify-content-between ui-attachment ".concat(oe[e.extension]||oe.image),children:[Object(R.jsx)("div",{className:"file-details d-flex align-items-center",children:Object(R.jsx)("div",{children:Object(R.jsx)("p",{className:"file-name mb-0 text-overflow-ellipsis",children:e.name.split(".")[0].length>15?"".concat(e.name.split(".")[0].substr(0,15)):e.name})})}),Object(R.jsx)(x.a,{size:14,className:"cursor-pointer",onClick:function(){return function(e,t){var n=Bt.filter((function(t){return t.name!==e.name}));Rt(Object(c.a)(qt.splice(t,1))),Ft(n)}(e,t)}})]},"".concat(e.name,"-").concat(t))}));Object(d.useEffect)(Object(r.a)(Object(i.a)().mark((function e(){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O.a.post("/clients/dropdown",{status:1}).then((function(e){var t=e.data;Ie(t.clients)})),O.a.post("/services/dropdown",{status:1}).then((function(e){var t=e.data;Se(t.services)})),O.a.post("/taxgroups/dropdown",{country:$.countryshortname}).then((function(e){var t=e.data;Ve(t.taxgroups)})),Ut(),Wt(),e.next=7,pe(Object(A.l)(null));case 7:case"end":return e.stop()}}),e)}))),[]);var nn=function(e){var t,n=Array.isArray(e)?e.map((function(e){return e.id})):[];t=n.length>0?Ae.filter((function(e){var t=e.id;return!n.some((function(e){return e===t}))})):Ae,ve(t),se("assignee",n)},an=function(e){var t,n=Array.isArray(e)?e.map((function(e){return e.id})):[];t=n.length>0?Ae.filter((function(e){var t=e.id;return!n.some((function(e){return e===t}))})):Ae,je(t),se("reviewer",n)};return Object(R.jsx)(B.a,{blocking:V,loader:Object(R.jsx)(D,{}),children:Object(R.jsxs)("form",{onSubmit:ce(Kt),children:[Object(R.jsxs)(z.l,{className:"invoice-preview-card",children:[Object.keys(ie).map((function(e,t){var n;return Object(R.jsxs)(z.I,{children:[" ",null===(n=ie[e])||void 0===n?void 0:n.message]},t)})),Object(R.jsx)(z.p,{children:"Add Task"}),Object(R.jsx)(z.m,{className:"pb-2 px-2",children:Object(R.jsxs)(z.ib,{children:[Object(R.jsxs)("div",{className:"col-lg-6 col-sm-12",children:[Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label required",for:"clientId",children:"Client"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{control:re,name:"clientId",id:"clientId",render:function(e){var t=e.field,n=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)(Object(s.a)({},t),{},{inputRef:n,className:m()("react-select",{"is-invalid":ie.clientId})},t),{},{classNamePrefix:"select",options:he,value:he.find((function(e){return e.id===t.value})),onChange:function(e){t.onChange(e.id),Mt(e.id)},getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id}}))}}),ie.clientId&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(e=ie.clientId)||void 0===e?void 0:e.message})]})]}),Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label required",for:"serviceId",children:"Service"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{control:re,name:"serviceId",id:"serviceId",render:function(e){var t=e.field,n=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)(Object(s.a)({},t),{},{inputRef:n,className:m()("react-select",{"is-invalid":ie.serviceId})},t),{},{classNamePrefix:"select",options:ke,value:ke.find((function(e){return e.id===t.value})),onChange:function(e){var n;return n=e.id,0===re._formValues.invoiceItems.length&&Wt(n),se("invoiceItems[0].serviceId",n),$t(0,!1,!1,!1,!1,!0),t.onChange(e.id)},getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id}}))}}),ie.serviceId&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(t=ie.serviceId)||void 0===t?void 0:t.message})]})]}),Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label",for:"description",children:"Description"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{id:"description",name:"description",control:re,render:function(e){var t=e.field;return Object(R.jsx)(z.K,Object(s.a)({type:"textarea",onInput:function(e){gt(e.target.value)},invalid:ie.description&&!0},t))}}),ie.description&&Object(R.jsx)(z.I,{children:ie.description.message})]})]}),Object(R.jsx)(z.ib,{className:"my-2",children:Object(R.jsx)(z.B,{children:Object(R.jsxs)("div",{className:"d-lg-flex",children:[Object(R.jsx)("input",Object(s.a)({},Qt())),Object(R.jsxs)(z.i,Object(s.a)(Object(s.a)({type:"button",color:"primary",size:"sm"},Zt({className:"dropzone"})),{},{children:[Object(R.jsx)(h.a,{size:14,className:""})," Add Attachment"]})),Tt>0&&Object(R.jsx)(z.hb,{className:"mt-md-50",color:Tt<100?"primary":"success",value:Tt})]})})}),Object(R.jsx)(z.ib,{children:Object(R.jsx)(z.ib,{className:"d-flex p-1",children:tn})})]}),Object(R.jsxs)("div",{className:"col-lg-6 col-sm-12",children:[Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label required",for:"assignee",children:"Assigned To"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{control:re,name:"assignee",id:"assignee",render:function(e){var t=e.field,n=e.value,a=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)({inputRef:a,className:m()("react-select",{"is-invalid":ie.assignee})},t),{},{classNamePrefix:"select",options:be,isMulti:!0,value:n,onChange:nn,getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id},styles:q}))}}),ie.assignee&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(n=ie.assignee)||void 0===n?void 0:n.message})]})]}),Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label",for:"reviewer",children:"Reviewer"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{control:re,name:"reviewer",id:"reviewer",render:function(e){var t=e.field,n=e.value,a=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)({inputRef:a,className:m()("react-select",{"is-invalid":ie.reviewer})},t),{},{classNamePrefix:"select",options:Oe,isMulti:!0,value:n,onChange:an,getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id},styles:q}))}}),ie.reviewer&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(a=ie.reviewer)||void 0===a?void 0:a.message})]})]}),Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label required",for:"startDate",children:"Start Date"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{value:J,name:"startDate",control:re,rules:{required:!0},options:{dateFormat:"d-m-Y"},render:function(e){var t=e.field;return Object(R.jsx)(p.a,{value:t.value,onChange:function(e,n){t.onChange(n)},options:{altInput:!0,altFormat:"F j, Y",dateFormat:"U"},className:m()("due-date-picker",{"flatpickr-input is-invalid":ie.startDate})})}}),ie.startDate&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(j=ie.startDate)||void 0===j?void 0:j.message})]})]}),Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label required",for:"endDate",children:"End Date"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{value:J,onChange:function(e){return H(e)},name:"endDate",control:re,rules:{required:!0},options:{dateFormat:"d-m-Y"},render:function(e){var t=e.field;return Object(R.jsx)(p.a,{value:t.value,onChange:function(e,n){t.onChange(n)},options:{altInput:!0,altFormat:"F j, Y",dateFormat:"U"},className:m()("due-date-picker",{"flatpickr-input is-invalid":ie.endDate})})}}),ie.endDate&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(v=ie.endDate)||void 0===v?void 0:v.message})]})]}),Object(R.jsxs)(z.ib,{className:"mb-1",children:[Object(R.jsx)(z.N,{sm:"3",size:"lg",className:"form-label required",for:"priority",children:"Priority"}),Object(R.jsxs)(z.B,{sm:"9",children:[Object(R.jsx)(y.a,{control:re,name:"priority",id:"priority",render:function(e){var t=e.field,n=e.value,a=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)(Object(s.a)({},t),{},{inputRef:a,className:m()("react-select",{"is-invalid":ie.priority})},t),{},{classNamePrefix:"select",options:le,value:le.find((function(e){return e.id===n})),onChange:function(e){return t.onChange(e.id)},getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id}}))}}),ie.priority&&Object(R.jsx)(z.I,{className:"text-danger",children:null===(I=ie.priority)||void 0===I?void 0:I.message})]})]})]})]})}),Object(R.jsx)("hr",{className:"invoice-spacing"}),Object(R.jsx)(z.ib,{className:"px-1 pb-2",children:Object(R.jsxs)("div",{className:"form-check form-check-primary mx-2",children:[Object(R.jsx)(y.a,{control:re,name:"invoiceFlag",rules:{required:!0},render:function(e){var t=e.field;return Object(R.jsx)(z.K,Object(s.a)(Object(s.a)({className:"form-check-input",type:"checkbox",id:"invoice_flag"},t),{},{onChange:function(e){t.onChange(e),function(){if(Ee(!De),se("invoiceFlag",!De),De)Ct();else if(0===re._formValues.invoiceItems.length){var e=re._formValues.serviceId;Wt(e),se("invoiceItems[0].serviceId",e),$t(0,!1,!1,!1,!1,!0)}}()},defaultChecked:De}))}}),Object(R.jsx)(z.N,{className:"form-check-label",for:"invoice_flag",children:"Create Profoma Invoice for this Task"})]})}),De&&Object(R.jsxs)(z.m,{className:"invoice-padding invoice-product-details",children:[St.map((function(e,t){var n,a,c,i,r,o,l,d;return Object(R.jsx)("div",{className:"repeater-wrapper",children:Object(R.jsxs)(z.ib,{className:"product-details-border",children:[Object(R.jsxs)(z.ib,{className:"d-lg-flex position-relative w-100 pe-lg-0 pe-1 py-50",md:12,children:[Object(R.jsxs)(z.B,{className:"mb-lg-0 mb-2 mt-lg-0 mt-2",md:3,sm:12,children:[Object(R.jsx)(z.u,{className:"col-title mb-md-50 mb-0",children:"Item"}),Object(R.jsx)(y.a,{control:re,name:"invoiceItems[".concat(t,"].serviceId"),rules:{required:!0},render:function(e){var n,a,c=e.field,i=e.ref;return Object(R.jsx)(N.a,Object(s.a)(Object(s.a)({},c),{},{inputRef:i,className:m()("react-select",{"is-invalid":null===(n=ie.invoiceItems)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.serviceId}),classNamePrefix:"select",options:ke,value:ke.find((function(e){return e.id===c.value})),onChange:function(e){c.onChange(e.id),bt(!0),$t(t,!1,!1,!1,!1,!0)},getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id}}))}}),(null===(n=ie.invoiceItems)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.serviceId)&&Object(R.jsx)(z.I,{children:null===(c=ie.invoiceItems)||void 0===c||null===(i=c[t])||void 0===i?void 0:i.serviceId.message})]}),Object(R.jsx)(z.B,{lg:4,children:Object(R.jsx)(y.a,{id:"rows_".concat(t,"_description"),name:"invoiceItems[".concat(t,"].description"),control:re,render:function(e){var n,a,c=e.field;return Object(R.jsx)(z.K,Object(s.a)({placeholder:"Description",invalid:(null===(n=ie.invoiceItems)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.description)&&!0,onInput:function(e){c.onChange(e),$t(t,!0,!1,!1,!1,!1)}},c))}})}),Object(R.jsxs)(z.B,{className:"my-lg-0 my-2",lg:"3",sm:"12",children:[Object(R.jsx)(z.u,{className:"col-title mb-md-2 mb-0",children:"Price"}),Object(R.jsx)(y.a,{id:"rows_".concat(t,"_price"),name:"invoiceItems[".concat(t,"].price"),control:re,render:function(e){var n,a,c=e.field;return Object(R.jsx)(z.K,Object(s.a)(Object(s.a)({type:"number",id:"input_rows_".concat(t,"_price"),onInput:function(e){c.onChange(e),$t(t,!1,!0,!1,!1,!1),bt(!0)}},c),{},{invalid:(null===(n=ie.invoiceItems)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.price)&&!0}))}}),(null===(r=ie.invoiceItems)||void 0===r||null===(o=r[t])||void 0===o?void 0:o.price)&&Object(R.jsx)(z.I,{children:null===(l=ie.invoiceItems)||void 0===l||null===(d=l[t])||void 0===d?void 0:d.price.message})]}),Object(R.jsxs)(z.B,{className:"my-lg-0 mt-2",lg:"1",sm:"12",children:[Object(R.jsx)(z.u,{className:"col-title mb-md-50 mb-0",children:"Amount"}),re._formValues.invoiceItems[t].subTotalAmount]}),Object(R.jsx)(z.B,{md:1,children:Object(R.jsx)("div",{className:"d-lg-flex justify-content-center border-start invoice-product-actions py-50 px-25",children:Object(R.jsx)(W.a,{size:18,className:"cursor-pointer",onClick:function(){Ct(t),Xt()}})})})]}),Object(R.jsx)(te,{parentaxCallback:en,refreshTax:ut,taxGroupOptions:Pe,mainInd:t,itemAmount:re._formValues.invoiceItems[t].price,errors:ie,control:re})]})},e.rowid)})),Object(R.jsx)(z.ib,{className:"mt-1",children:Object(R.jsx)(z.B,{sm:"12",className:"px-0",children:Object(R.jsxs)(z.i,{color:"primary",size:"sm",className:"btn-add-new",onClick:function(){return Wt()},children:[Object(R.jsx)(g.a,{size:14,className:"me-25"})," ",Object(R.jsx)("span",{className:"align-middle",children:"Add Item"})]})})})]})]}),Object(R.jsx)(z.l,{children:Object(R.jsx)(z.m,{children:Object(R.jsxs)("div",{className:"modal-footer border-0",children:[Object(R.jsx)(z.i,{className:"add-new-user",outline:!0,color:"warning",tag:b.b,to:"/task/list",children:"Cancel"}),Object(R.jsx)(z.i,{color:"primary",type:"submit",children:"Save"})]})})})]})})},ae=Object(V.a)();t.default=function(){return Object(R.jsx)("div",{className:"invoice-add-wrapper",children:Object(R.jsx)(z.ib,{className:"invoice-add",children:Object(R.jsx)(z.B,{xl:12,md:12,sm:12,children:"IN"===ae.countryshortname?Object(R.jsx)(Z,{}):Object(R.jsx)(ne,{})})})})}},735:function(e,t,n){"use strict";var a=n(8),c=n(27),i=n(0),r=n(7),s=n.n(r),o=n(14),l=(n(738),n(3)),d=function(e){var t,n=e.children,r=e.blocking,o=e.loader,d=e.className,u=e.tag,b=e.overlayColor,j=u;return Object(l.jsxs)(j,{className:s()("ui-loader",(t={},Object(c.a)(t,d,d),Object(c.a)(t,"show",r),t)),children:[n,r?Object(l.jsxs)(i.Fragment,{children:[Object(l.jsx)("div",Object(a.a)({className:"overlay"},r&&b?{style:{backgroundColor:b}}:{})),Object(l.jsx)("div",{className:"loader",children:o})]}):null]})};t.a=d,d.defaultProps={tag:"div",blocking:!1,loader:Object(l.jsx)(o.jb,{color:"primary"})}},736:function(e,t,n){"use strict";var a=n(3);t.a=function(){return Object(a.jsx)("div",{className:"fallback-spinner",children:Object(a.jsxs)("div",{className:"loading",children:[Object(a.jsx)("div",{className:"effect-1 effects"}),Object(a.jsx)("div",{className:"effect-2 effects"}),Object(a.jsx)("div",{className:"effect-3 effects"})]})})}},737:function(e,t,n){},738:function(e,t,n){},743:function(e,t,n){},746:function(e,t,n){},790:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var a=function(e,t,n){var a=0;return 1===n?a=parseFloat(e)-parseFloat(e)*(100/(100+parseFloat(t))):2===n&&(a=parseFloat(e)*parseFloat(t)/100),parseFloat(a)},c=function(e){return JSON.parse(Array.isArray(e)?JSON.stringify(e).replace(/\\/g,""):e.replace(/\\/g,""))}}}]);
//# sourceMappingURL=57.1bec18a5.chunk.js.map