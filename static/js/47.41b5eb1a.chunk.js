(this["webpackJsonpvuexy-react-admin-dashboard"]=this["webpackJsonpvuexy-react-admin-dashboard"]||[]).push([[47],{1288:function(e,t,a){"use strict";a.r(t);var n=a(8),r=a(19),s=a(3),c=a(5),l=a(10),o=a(0),i=a(1136),d=a(33),u=a(52),h=a(182),f=a(754),p=a(279),m=a(219),k=a(706),b=a(13),y=a(700),j=a(701),g=(a(779),a(21)),x=a(22),v=a(6),O=a(42),w=a.n(O),D=a(2);t.default=function(){var e=Object(x.g)().module,t=Object(x.f)(),a=Object(o.useState)(!1),O=Object(l.a)(a,2),C=O[0],S=O[1],B=function(){return Object(D.jsx)(o.Fragment,{children:Object(D.jsx)(j.a,{})})},E=Object(g.c)((function(e){return e.importExcel})),$=Object(g.b)(),A=Object(o.useState)(""),N=Object(l.a)(A,2),M=N[0],V=N[1],W=Object(o.useState)(""),F=Object(l.a)(W,2),P=F[0],I=F[1],T=Object(o.useState)([]),_=Object(l.a)(T,2),Y=_[0],R=_[1],U=Object(o.useState)([]),L=Object(l.a)(U,2),H=L[0],G=L[1],z=Object(o.useState)([]),J=Object(l.a)(z,2),K=J[0],Q=J[1],q=function(e,t){R(e),V(t)},Z=Object(f.a)({multiple:!1,onDrop:function(t){var a=new FileReader;a.onload=Object(c.a)(Object(s.a)().mark((function n(){var r,c,l,o,i,u,h,f,p,m,k;return Object(s.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:R([]),V(""),r=a.result,c=d.read(r,{type:"binary",cellDates:!0}),l=Object.keys(c.Sheets)[0],o=d.utils.sheet_to_row_object_array(c.Sheets[l]),i=d.utils.decode_range(c.Sheets[l]["!ref"]),u=[],h=i.s.c;case 9:if(!(h<=i.e.c)){n.next=18;break}if(f=d.utils.encode_cell({r:i.s.r,c:h}),p=c.Sheets[l][f]){n.next=14;break}return n.abrupt("continue",15);case 14:u.push(p.v.toLowerCase().split(" ").reduce((function(e,t){return e+((null===t||void 0===t?void 0:t.charAt(0).toUpperCase())+t.slice(1))})));case 15:++h,n.next=9;break;case 18:return m=d.utils.sheet_to_json(c.Sheets[l],{header:u,cellDates:!0,range:1,defval:""}),n.next=21,q(o,t[0].name);case 21:return k=m,"tasks"!==e&&"recurring-task"!==e||(k=[],m.forEach((function(e){var t=e;"object"===typeof e.startDate&&(t.startDate=w()(new Date(e.startDate)).add(1,"d").startOf("d").format("DD/MM/Y"),t.endDate=w()(new Date(e.endDate)).add(1,"d").startOf("d").format("DD/MM/Y")),k.push(t)}))),"invoice"!==e&&"reimbursement"!==e||(k=[],m.forEach((function(e){var t=e;"object"===typeof e.invoiceDate&&(t.invoiceDate=w()(new Date(e.invoiceDate)).add(1,"d").startOf("d").format("DD/MM/Y"),t.dueDate=w()(new Date(e.dueDate)).add(1,"d").startOf("d").format("DD/MM/Y")),k.push(t)}))),"digitalsignatures"!==e&&"license"!==e||(k=[],m.forEach((function(e){var t=e;"object"===typeof e.issuedDate&&(t.issuedDate=w()(new Date(e.issuedDate)).add(1,"d").startOf("d").format("DD/MM/Y"),t.expiryDate=w()(new Date(e.expiryDate)).add(1,"d").startOf("d").format("DD/MM/Y")),k.push(t)}))),"holidays"===e&&(k=[],m.forEach((function(e){var t=e;"object"===typeof e["date(dd/mm/y)"]&&(t.date=w()(new Date(e["date(dd/mm/y)"])).add(1,"d").startOf("d").format("DD/MM/Y")),k.push(t)}))),n.next=28,G(k);case 28:case"end":return n.stop()}}),n)}))),t.length&&t[0].name.endsWith("xlsx")?a.readAsBinaryString(t[0]):h.b.error((function(){return Object(D.jsxs)("p",{className:"mb-0",children:["You can only upload ",Object(D.jsx)("span",{className:"fw-bolder",children:".xlsx"}),", ",Object(D.jsx)("span",{className:"fw-bolder",children:".xls"})," &"," ",Object(D.jsx)("span",{className:"fw-bolder",children:".csv"})," Files!."]})}),{style:{minWidth:"380px"}})}}),X=Z.getRootProps,ee=Z.getInputProps,te=function(){var t=Object(c.a)(Object(s.a)().mark((function t(){var a,n;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=["Low","Medium","High"],n=["Monthly","Yearly","Quarterly"],v.a.post("/modules/taskutilities").then(function(){var t=Object(c.a)(Object(s.a)().mark((function t(r){var c,l,o,d,h,f,p,m;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.data.result.clients,l=r.data.result.services,o=r.data.result.users,d=new i.Workbook,h=d.addWorksheet("Sheet 1"),f=d.addWorksheet("Sheet 2"),c.forEach((function(e,t){f.getCell("A".concat(t+1)).value=e})),l.forEach((function(e,t){f.getCell("B".concat(t+1)).value=e})),a.forEach((function(e,t){f.getCell("C".concat(t+1)).value=e})),o.forEach((function(e,t){f.getCell("D".concat(t+1)).value=e})),o.forEach((function(e,t){f.getCell("E".concat(t+1)).value=e})),n.forEach((function(e,t){f.getCell("H".concat(t+1)).value=e})),"tasks"===e?h.columns=[{header:"Client",key:"client"},{header:"Service",key:"service"},{header:"Priority",key:"priority"},{header:"Assignee",key:"assignee"},{header:"Reviewer",key:"reviewer"},{header:"Start Date",key:"sartdate"},{header:"End Date",key:"enddate"}]:"recurring-task"===e&&(h.columns=[{header:"Client",key:"client"},{header:"Service",key:"service"},{header:"Priority",key:"priority"},{header:"Assignee",key:"assignee"},{header:"Reviewer",key:"reviewer"},{header:"Start Date",key:"sartdate"},{header:"End Date",key:"enddate"},{header:"Recurring Duration",key:"recurringduration"},{header:"Quarterly Dates",key:"quarterlydates"}]),h.getCell("A2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$A$1:A".concat(c.length)]},h.getCell("B2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$B$1:B".concat(l.length)]},h.getCell("C2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$C$1:C".concat(a.length)]},h.getCell("D2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$D$1:D".concat(o.length)]},h.getCell("E2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$E$1:E".concat(o.length)]},"recurring-task"===e&&(h.getCell("H2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$H$1:H".concat(n.length)]}),t.next=21,d.xlsx.writeBuffer();case 21:p=t.sent,m=new Blob([p],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),u.saveAs(m,"Task_SampleData.xlsx");case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ae=function(){var e=Object(c.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v.a.post("/modules/clientutilities").then(function(){var e=Object(c.a)(Object(s.a)().mark((function e(t){var a,n,r,c,l,o,d,h,f,p,m;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.result.countries,n=t.data.result.gstregistrationtypes,r=t.data.result.businessentities,c=t.data.result.states,l=t.data.result.users,o=t.data.result.currencie,d=new i.Workbook,h=d.addWorksheet("Sheet 1"),f=d.addWorksheet("Sheet 2"),r.forEach((function(e,t){f.getCell("A".concat(t+1)).value=e})),c.forEach((function(e,t){f.getCell("B".concat(t+1)).value=e})),a.forEach((function(e,t){f.getCell("C".concat(t+1)).value=e})),n.forEach((function(e,t){f.getCell("D".concat(t+1)).value=e})),l.forEach((function(e,t){f.getCell("E".concat(t+1)).value=e})),o.forEach((function(e,t){f.getCell("F".concat(t+1)).value=e})),h.columns=[{header:"Business Name",key:"businessname"},{header:"Client Name",key:"clientname"},{header:"Email",key:"email"},{header:"Contact Number ",key:"contactnumber"},{header:"Business Entity",key:"businessentity"},{header:"Assign User",key:"assignuser"},{header:"Place Of Supply",key:"placeofsupply"},{header:"Currency",key:"currency"},{header:"GSTIN",key:"gstin"},{header:"GST Resgitered Type",key:"gstregisteredtype"},{header:"Address Line 1",key:"addressline1"},{header:"Addresss Line 2",key:"addressline2"},{header:"City",key:"city"},{header:"State",key:"state"},{header:"Country",key:"country"},{header:"ZIP Code",key:"zipcode"},{header:"Contact Person Name 1",key:"contactpersonname1"},{header:"Contact Person Email 1",key:"contactpersonname2"},{header:"Contact Person Contact 1",key:"contactpersoncontact1"},{header:"Contact Person Designation 1",key:"contactpersondesignation1"},{header:"Contact Person Primary Status 1",key:"contactpersonprimarystatus1"},{header:"Contact Person Adhaar 1",key:"contactpersonadhaar1"},{header:"Contact Person DIN 1",key:"contactpersondin1"},{header:"Contact Person PAN 1",key:"contactpersonpan1"},{header:"Registration No",key:"registrationNo"}],h.getCell("E2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$A$1:A".concat(r.length)]},h.getCell("F2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$E$1:E".concat(l.length)]},h.getCell("G2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$B$1:B".concat(c.length)]},h.getCell("H2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$F$1:F".concat(o.length)]},h.getCell("J2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$D$1:D".concat(n.length)]},h.getCell("N2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$B$1:B".concat(c.length)]},h.getCell("O2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$C$1:C".concat(a.length)]},e.next=25,d.xlsx.writeBuffer();case 25:p=e.sent,m=new Blob([p],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),u.saveAs(m,"Client_SampleData.xlsx");case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=Object(c.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v.a.post("/modules/serviceutilities").then(function(){var e=Object(c.a)(Object(s.a)().mark((function e(t){var a,n,r,c,l,o,d,h;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.result.serviceforms,n=t.data.result.taxgroups,r=t.data.result.exemptionreasons,c=new i.Workbook,l=c.addWorksheet("Sheet 1"),o=c.addWorksheet("Sheet 2"),a.forEach((function(e,t){o.getCell("A".concat(t+1)).value=e})),n.forEach((function(e,t){o.getCell("B".concat(t+1)).value=e})),r.forEach((function(e,t){o.getCell("C".concat(t+1)).value=e})),l.columns=[{header:"Service Name",key:"servicename"},{header:"Professional Fee",key:"fee"},{header:"Forms",key:"foms"},{header:"Description ",key:"description"},{header:"Tax Rate",key:"taxgroup"},{header:"Exemption Reason",key:"exemptionReason"},{header:"SAC Code",key:"saccode"}],l.getCell("C2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$A$1:A".concat(a.length)]},l.getCell("E2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$B$1:B".concat(n.length)]},l.getCell("F2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$C$1:C".concat(r.length)]},e.next=15,c.xlsx.writeBuffer();case 15:d=e.sent,h=new Blob([d],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),u.saveAs(h,"Service_SampleData.xlsx");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=Object(c.a)(Object(s.a)().mark((function e(){var t,a,n;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new i.Workbook,t.addWorksheet("Sheet 1").columns=[{header:"Name",key:"name"},{header:"Date (DD/MM/Y)",key:"date"},{header:"Comments",key:"comments"}],e.next=5,t.xlsx.writeBuffer();case 5:a=e.sent,n=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),u.saveAs(n,"Holidays_SampleData.xlsx");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(){switch(e){case"tasks":case"recurring-task":te();break;case"clients":ae();break;case"subtask":v.a.post("/services/dropdown").then(function(){var e=Object(c.a)(Object(s.a)().mark((function e(t){var a,n,r,c,l,o;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.services.map((function(e){return e.name})),n=new i.Workbook,r=n.addWorksheet("Sheet 1"),c=n.addWorksheet("Sheet 2"),a.forEach((function(e,t){c.getCell("A".concat(t+1)).value=e})),r.columns=[{header:"Service",key:"service"},{header:"Name",key:"name"},{header:"Description",key:"description"},{header:"Task Index",key:"taskIndex"}],r.getCell("A2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$A$1:A".concat(a.length)]},e.next=9,n.xlsx.writeBuffer();case 9:l=e.sent,o=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),u.saveAs(o,"SubTask_SampleData.xlsx");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());break;case"passwordmanage":v.a.post("/modules/passwordmanage").then(function(){var e=Object(c.a)(Object(s.a)().mark((function e(t){var a,n,r,c,l,o,d;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.result.passwordmasters,n=t.data.result.clients,r=new i.Workbook,c=r.addWorksheet("Sheet 1"),l=r.addWorksheet("Sheet 2"),n.forEach((function(e,t){l.getCell("A".concat(t+1)).value=e})),a.forEach((function(e,t){l.getCell("B".concat(t+1)).value=e})),c.columns=[{header:"Client",key:"client"},{header:"Password Master",key:"passwordmaster"},{header:"Username",key:"username"},{header:"Password",key:"password"},{header:"remarks",key:"remarks"}],c.getCell("A2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$A$1:A".concat(n.length)]},c.getCell("B2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$B$1:B".concat(a.length)]},e.next=12,r.xlsx.writeBuffer();case 12:o=e.sent,d=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),u.saveAs(d,"Password_Manager_SampleData.xlsx");case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());break;case"holidays":re();break;case"services":ne();break;case"invoice":v.a.post("/modules/invoiceutilities").then(function(){var e=Object(c.a)(Object(s.a)().mark((function e(t){var a,n,r,c,l,o,d,h,f,p,m,k,b;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.result.users,n=t.data.result.clients,r=t.data.result.services,c=t.data.result.states,l=t.data.result.transactionaccounts,o=t.data.result.taxgroups,d=t.data.result.exemptionreasons,h=["Proposal","Invoice"],f=new i.Workbook,p=f.addWorksheet("Sheet 1"),m=f.addWorksheet("Sheet 2"),n.forEach((function(e,t){m.getCell("A".concat(t+1)).value=e})),l.forEach((function(e,t){m.getCell("B".concat(t+1)).value=e})),a.forEach((function(e,t){m.getCell("C".concat(t+1)).value=e})),r.forEach((function(e,t){m.getCell("D".concat(t+1)).value=e})),o.forEach((function(e,t){m.getCell("E".concat(t+1)).value=e})),d.forEach((function(e,t){m.getCell("F".concat(t+1)).value=e})),c.forEach((function(e,t){m.getCell("G".concat(t+1)).value=e})),h.forEach((function(e,t){m.getCell("H".concat(t+1)).value=e})),p.columns=[{header:"Client",key:"client"},{header:"Invoice Date",key:"invoiceDate"},{header:"Due Date",key:"dueDate"},{header:"Bank Account",key:"bankAccount"},{header:"Employee",key:"employees"},{header:"GSTIN",key:"gstin"},{header:"Place Of Supply",key:"placeofsupply"},{header:"Service",key:"service"},{header:"Description",key:"description"},{header:"SAC code",key:"sacCode"},{header:"Tax Rate",key:"taxRate"},{header:"Exemption Reason",key:"exemptionReason"},{header:"Price",key:"price"},{header:"Option",key:"option"}],p.getCell("A2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$A$1:A".concat(n.length)]},p.getCell("D2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$B$1:B".concat(l.length)]},p.getCell("E2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$C$1:C".concat(a.length)]},p.getCell("G2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$G$1:G".concat(r.length)]},p.getCell("H2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$D$1:D".concat(o.length)]},p.getCell("K2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$E$1:E".concat(o.length)]},p.getCell("L2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$F$1:F".concat(d.length)]},p.getCell("N2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$H$1:H".concat(d.length)]},e.next=30,f.xlsx.writeBuffer();case 30:k=e.sent,b=new Blob([k],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),u.saveAs(b,"Invoice_SampleData.xlsx");case 33:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());break;case"digitalsignatures":v.a.post("/modules/taskutilities").then(function(){var e=Object(c.a)(Object(s.a)().mark((function e(t){var a,n,r,c,l,o;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.result.clients,n=new i.Workbook,r=n.addWorksheet("Sheet 1"),c=n.addWorksheet("Sheet 2"),a.forEach((function(e,t){c.getCell("A".concat(t+1)).value=e})),r.columns=[{header:"Client",key:"client"},{header:"Name",key:"name"},{header:"Email",key:"email"},{header:"Mobile",key:"mobile"},{header:"Issued Date",key:"issuedDate"},{header:"Expiry Date",key:"expiryDate"},{header:"Password",key:"password"}],r.getCell("A2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$A$1:A".concat(a.length)]},e.next=9,n.xlsx.writeBuffer();case 9:l=e.sent,o=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),u.saveAs(o,"DigitalSignatures_SampleData.xlsx");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());break;case"license":v.a.post("/modules/taskutilities").then(function(){var e=Object(c.a)(Object(s.a)().mark((function e(t){var a,n,r,c,l,o;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.result.clients,n=new i.Workbook,r=n.addWorksheet("Sheet 1"),c=n.addWorksheet("Sheet 2"),a.forEach((function(e,t){c.getCell("A".concat(t+1)).value=e})),r.columns=[{header:"Client",key:"client"},{header:"License Name",key:"name"},{header:"License No",key:"email"},{header:"Issued Date",key:"issuedDate"},{header:"Expiry Date",key:"expiryDate"}],r.getCell("A2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$A$1:A".concat(a.length)]},e.next=9,n.xlsx.writeBuffer();case 9:l=e.sent,o=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),u.saveAs(o,"License_SampleData.xlsx");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());break;case"reimbursement":v.a.post("/modules/reimbursementutilities").then(function(){var e=Object(c.a)(Object(s.a)().mark((function e(t){var a,n,r,c,l,o,d,h,f,p;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.result.users,n=t.data.result.clients,r=t.data.result.services,c=t.data.result.states,l=t.data.result.transactionaccounts,o=new i.Workbook,d=o.addWorksheet("Sheet 1"),h=o.addWorksheet("Sheet 2"),n.forEach((function(e,t){h.getCell("A".concat(t+1)).value=e})),l.forEach((function(e,t){h.getCell("B".concat(t+1)).value=e})),a.forEach((function(e,t){h.getCell("C".concat(t+1)).value=e})),r.forEach((function(e,t){h.getCell("D".concat(t+1)).value=e})),c.forEach((function(e,t){h.getCell("E".concat(t+1)).value=e})),d.columns=[{header:"Client",key:"client"},{header:"Invoice Date",key:"invoiceDate"},{header:"Due Date",key:"dueDate"},{header:"Bank Account",key:"bankAccount"},{header:"Employee",key:"employees"},{header:"Place Of Supply",key:"placeofsupply"},{header:"Service",key:"service"},{header:"Description",key:"description"},{header:"SAC code",key:"sacCode"},{header:"Price",key:"price"}],d.getCell("A2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$A$1:A".concat(n.length)]},d.getCell("D2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$B$1:B".concat(l.length)]},d.getCell("E2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$C$1:C".concat(a.length)]},d.getCell("F2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$E$1:E".concat(c.length)]},d.getCell("G2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$D$1:D".concat(r.length)]},e.next=21,o.xlsx.writeBuffer();case 21:f=e.sent,p=new Blob([f],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),u.saveAs(p,"Reimbursement_SampleData.xlsx");case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());break;case"team":v.a.post("/modules/teamutilities").then(function(){var e=Object(c.a)(Object(s.a)().mark((function e(t){var a,n,r,c,l,o,d,h;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.result.roles,n=t.data.result.departments,r=t.data.result.designations,c=new i.Workbook,l=c.addWorksheet("Sheet 1"),o=c.addWorksheet("Sheet 2"),a.forEach((function(e,t){o.getCell("A".concat(t+1)).value=e})),n.forEach((function(e,t){o.getCell("B".concat(t+1)).value=e})),r.forEach((function(e,t){o.getCell("C".concat(t+1)).value=e})),l.columns=[{header:"First Name",key:"firstname"},{header:"Last Name",key:"lastname"},{header:"Email",key:"email"},{header:"Contact",key:"contact"},{header:"Role",key:"rolw"},{header:"Department",key:"department"},{header:"Designation",key:"designation"}],l.getCell("E2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$A$1:A".concat(a.length)]},l.getCell("F2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$B$1:B".concat(n.length)]},l.getCell("G2").dataValidation={type:"list",allowBlank:!0,formulae:["'Sheet 2'!$C$1:C".concat(r.length)]},e.next=15,c.xlsx.writeBuffer();case 15:d=e.sent,h=new Blob([d],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),u.saveAs(h,"Team_SampleData.xlsx");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},ce=Y.length?Y.map((function(e,t){return 0===t?Object(r.a)(Object.keys(e)):null})):[],le=P.length?K:Y.length&&!P.length?Y:null,oe=function(){return null!==le&&le.length?le.map((function(t,a){var n=!1,r=Object.keys(t);r.push("Error"),"tasks"!==e&&"recurring-task"!==e||"object"===typeof t["Start Date"]&&(t["Start Date"]=w()(new Date(t["Start Date"])).add(1,"d").startOf("d").format("MMM DD, Y"),t["End Date"]=w()(new Date(t["End Date"])).add(1,"d").startOf("d").format("MMM DD, Y")),"invoice"!==e&&"reimbursement"!==e||"object"===typeof t["Invoice Date"]&&(t["Invoice Date"]=w()(new Date(t["Invoice Date"])).add(1,"d").startOf("d").format("MMM DD, Y"),t["Due Date"]=w()(new Date(t["Due Date"])).add(1,"d").startOf("d").format("MMM DD, Y")),"digitalsignatures"!==e&&"license"!==e||"object"===typeof t["Issued Date"]&&(t["Issued Date"]=w()(new Date(t["Issued Date"])).add(1,"d").startOf("d").format("MMM DD, Y"),t["Expiry Date"]=w()(new Date(t["Expiry Date"])).add(1,"d").startOf("d").format("MMM DD, Y")),"holidays"===e&&"object"===typeof t["Date (DD/MM/Y)"]&&(t["Date (DD/MM/Y)"]=w()(new Date(t["Date (DD/MM/Y)"])).add(1,"d").startOf("d").format("MMM DD, Y"));var s=r.map((function(e,r){return E.importErrors.length>0&&(n=Object.keys(E.importErrors[a]).length>0),"Error"===e?Object(D.jsx)("td",{className:"text-warning",children:E.importErrors.length>0&&E.importErrors[a].map((function(e,t){return Object(D.jsx)("p",{className:"text-sm",children:e},t)}))},r):Object(D.jsx)("td",{children:t[e]},r)}));return Object(D.jsx)("tr",{className:n?"bg-light-warning":"",children:s},a)})):null};Object(o.useEffect)((function(){E.importErrors.length>0&&oe()}),[E.importErrors]);var ie=function(){var a=Object(c.a)(Object(s.a)().mark((function a(){return Object(s.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==E.importErrors.length){a.next=6;break}return a.next=3,h.b.success("Imported SuccessFully");case 3:t("holidays"===e?"/attendancesetting/holidays":"tasks"===e?"/task/list":"passwordmanage"===e?"/clients/list":"subtask"===e?"/services/list":"license"===e||"digitalsignatures"===e?"/clients/list":"/".concat(e,"/list")),a.next=8;break;case 6:return a.next=8,h.b.error("Imported Failed, Please Fix Errors");case 8:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),de=function(){var t=Object(c.a)(Object(s.a)().mark((function t(){var a,n;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return S(!0),a=e,"invoice"===e?a="taskinvoices":"reimbursement"===e?a="reimbursementinvoice":"license"===e?a="digitalsignatures":"team"===e&&(a="organizationusers"),n={data:H,module:"subtask"===a?"workflows":a,submodule:"license"===e?"licenseimport":"import",validationflag:!1},t.next=6,$(Object(m.b)(n));case 6:S(!1),ie();case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(o.useEffect)(Object(c.a)(Object(s.a)().mark((function t(){var a,n;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(null!==H&&H.length>0)){t.next=8;break}return S(!0),a=e,"invoice"===e?a="taskinvoices":"reimbursement"===e?a="reimbursementinvoice":"license"===e?a="digitalsignatures":"team"===e&&(a="organizationusers"),n={data:H,module:"subtask"===a?"workflows":a,submodule:"license"===e?"licenseimport":"import",validationflag:!0},t.next=7,$(Object(m.b)(n));case 7:S(!1);case 8:case"end":return t.stop()}}),t)}))),[H]),Object(D.jsxs)(o.Fragment,{children:[Object(D.jsx)(k.a,{title:"".concat("passwordmanage"===e?"Import Password Manager":"Import ".concat((null===e||void 0===e?void 0:e.charAt(0).toUpperCase())+e.substring(1)))}),Object(D.jsxs)(y.a,{blocking:C,loader:Object(D.jsx)(B,{}),children:[Object(D.jsxs)(b.ib,{className:"import-component",children:[Object(D.jsx)(b.ib,{children:Object(D.jsx)(b.B,{sm:"12",md:"9",children:Object(D.jsx)(b.l,{children:Object(D.jsxs)(b.m,{children:[Object(D.jsx)(b.B,{sm:"12",md:"3",className:"py-50",children:Object(D.jsx)("span",{className:"text-primary cursor-pointer",onClick:function(){se()},children:" Download Sample Excel"})}),Object(D.jsx)(b.ib,{children:Object(D.jsx)(b.B,{sm:"12",children:Object(D.jsxs)("div",Object(n.a)(Object(n.a)({},X({className:"dropzone"})),{},{children:[Object(D.jsx)("input",Object(n.a)({},ee())),Object(D.jsxs)("div",{className:"d-flex align-items-center justify-content-center flex-column",children:[Object(D.jsx)(p.a,{size:64}),Object(D.jsx)("h5",{children:"Drop Files here or click to upload"}),Object(D.jsxs)("p",{className:"text-secondary",children:["Drop files here or click"," ",Object(D.jsx)("a",{href:"/",onClick:function(e){return e.preventDefault()},children:"browse"})," ","thorough your machine"]})]})]}))})})]})})})}),Y.length?Object(D.jsx)(b.B,{sm:"12",children:Object(D.jsxs)(b.l,{children:[Object(D.jsxs)(b.p,{className:"justify-content-between flex-wrap",children:[Object(D.jsx)(b.v,{tag:"h4",children:M}),Object(D.jsxs)("div",{className:"d-flex align-items-center justify-content-end",children:[Object(D.jsx)(b.N,{for:"search-input",className:"me-1",children:"Search"}),Object(D.jsx)(b.K,{id:"search-input",type:"text",bsSize:"sm",value:P,onChange:function(e){return function(e){var t=Y,a=[],n=e.target.value;if(I(n),!n.length)return null;a=t.filter((function(e){var t=Object.keys(e),a=t.filter((function(t){return e[t].toString().toLowerCase().startsWith(n.toLowerCase())})),r=t.filter((function(t){return e[t].toString().toLowerCase().includes(n.toLowerCase())}));return a.length?e[a]:!a&&r.length?e[r]:null})),Q(a),I(n)}(e)}})]})]}),Object(D.jsxs)(b.mb,{className:"table-hover-animation",responsive:!0,children:[Object(D.jsx)("thead",{children:Object(D.jsx)("tr",{children:ce.length?(ce[0].push("Error"),ce[0].map((function(e,t){return Object(D.jsx)("th",{children:e},t)}))):null})}),Object(D.jsx)("tbody",{children:oe()})]})]})}):null]}),Object(D.jsx)(b.ib,{className:"px-1",children:Object(D.jsx)(b.l,{className:"p-1",children:Object(D.jsxs)(b.B,{children:[Object(D.jsx)(b.i,{outline:!0,color:"warning",onClick:ie,children:"Cancel"}),Y.length>0&&Object(D.jsx)(b.i,{color:"primary",className:"ms-1",onClick:function(){de()},children:"Import"})]})})})]})]})}},700:function(e,t,a){"use strict";var n=a(8),r=a(24),s=a(0),c=a(7),l=a.n(c),o=a(13),i=(a(702),a(2)),d=function(e){var t,a=e.children,c=e.blocking,o=e.loader,d=e.className,u=e.tag,h=e.overlayColor,f=u;return Object(i.jsxs)(f,{className:l()("ui-loader",(t={},Object(r.a)(t,d,d),Object(r.a)(t,"show",c),t)),children:[a,c?Object(i.jsxs)(s.Fragment,{children:[Object(i.jsx)("div",Object(n.a)({className:"overlay"},c&&h?{style:{backgroundColor:h}}:{})),Object(i.jsx)("div",{className:"loader",children:o})]}):null]})};t.a=d,d.defaultProps={tag:"div",blocking:!1,loader:Object(i.jsx)(o.jb,{color:"primary"})}},701:function(e,t,a){"use strict";var n=a(2);t.a=function(){return Object(n.jsx)("div",{className:"fallback-spinner",children:Object(n.jsxs)("div",{className:"loading",children:[Object(n.jsx)("div",{className:"effect-1 effects"}),Object(n.jsx)("div",{className:"effect-2 effects"}),Object(n.jsx)("div",{className:"effect-3 effects"})]})})}},702:function(e,t,a){},706:function(e,t,a){"use strict";var n=a(13),r=a(2);t.a=function(e){return Object(r.jsx)(n.ib,{className:"mb-2",children:Object(r.jsxs)(n.B,{sm:"12",className:"ms-50",children:[Object(r.jsx)("p",{className:"font-medium-5 mt-1 extension-title","data-tour":"extension-title",children:e.title}),e.link?Object(r.jsx)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",children:e.subTitle}):Object(r.jsx)("p",{className:"text-primary",children:e.subTitle})]})})}},779:function(e,t,a){}}]);
//# sourceMappingURL=47.41b5eb1a.chunk.js.map