(this["webpackJsonpvuexy-react-admin-dashboard"]=this["webpackJsonpvuexy-react-admin-dashboard"]||[]).push([[31],{1404:function(e,t,c){"use strict";c.r(t);var n=c(10),a=c(0),s=c(3),r=c(5),i=c(136),l=c(701),o=c(702),j=c(340),d=c(258),b=c(338),u=c(245),h=c(306),O=c(330),x=c(355),f=c(282),p=c(13),m=(c(746),c(717),c(6)),g=c(42),v=c.n(g),y=c(2),N={Sent:{color:"light-secondary",icon:Object(y.jsx)(j.a,{size:14})},Paid:{color:"light-success",icon:Object(y.jsx)(d.a,{size:14})},Draft:{color:"light-primary",icon:Object(y.jsx)(b.a,{size:14})},Downloaded:{color:"light-info",icon:Object(y.jsx)(u.a,{size:14})},"Past Due":{color:"light-danger",icon:Object(y.jsx)(h.a,{size:14})},"Partial Payment":{color:"light-warning",icon:Object(y.jsx)(O.a,{size:14})}},w=function(e){var t=e.refreshHistory,c=Object(a.useState)([]),j=Object(n.a)(c,2),b=j[0],u=j[1],h=Object(a.useState)(!1),O=Object(n.a)(h,2),g=O[0],w=O[1],k=function(){return Object(y.jsx)(a.Fragment,{children:Object(y.jsx)(o.a,{})})},D=function(){var e=Object(r.a)(Object(s.a)().mark((function e(t){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:w(!0),m.a.post("/billings/exportpdf",{id:t.id}).then((function(e){var c=document.createElement("a"),n="".concat(t.uniqueno,".pdf");c.href=e.data.pdf,c.download=n,c.click(),document.removeChild(c),w(!1)})).catch((function(e){w(!1),console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){m.a.post("/billings/billinghistory").then((function(e){u(e.data.invoices)})).catch((function(){}))};Object(a.useEffect)((function(){z()}),[]),Object(a.useEffect)((function(){t&&z()}),[t]);return Object(y.jsx)("div",{className:"invoice-list-wrapper",children:Object(y.jsx)(p.l,{children:Object(y.jsxs)(l.a,{blocking:g,loader:Object(y.jsx)(k,{}),children:[Object(y.jsx)(p.p,{className:"py-1",children:Object(y.jsx)(p.v,{tag:"h4",children:"Billing History"})}),Object(y.jsx)("div",{className:"invoice-list-dataTable react-dataTable",children:Object(y.jsxs)(p.mb,{responsive:!0,className:"table table-hover",children:[Object(y.jsx)("thead",{children:Object(y.jsxs)("tr",{children:[Object(y.jsx)("th",{children:"#"}),Object(y.jsx)("th",{children:Object(y.jsx)(x.a,{size:14})}),Object(y.jsx)("th",{children:"Total"}),Object(y.jsx)("th",{children:"Issued Date"}),Object(y.jsx)("th",{children:"Due Date"}),Object(y.jsx)("th",{children:"Action"})]})}),Object(y.jsx)("tbody",{children:b.map((function(e,t){return Object(y.jsxs)("tr",{children:[Object(y.jsx)("td",{children:e.uniqueno}),Object(y.jsx)("td",{children:Object(y.jsxs)(a.Fragment,{children:[Object(y.jsx)(i.a,{color:N[e.status]?N[e.status].color:"success",icon:(c=e.status,N[c]?N[c].icon:Object(y.jsx)(d.a,{size:14})),id:"av-tooltip-".concat(e.id)}),Object(y.jsxs)(p.yb,{placement:"top",target:"av-tooltip-".concat(e.id),children:[Object(y.jsx)("span",{className:"fw-bold",children:e.status}),Object(y.jsx)("br",{}),Object(y.jsx)("span",{className:"fw-bold",children:"Balance:"})," ",e.balance,Object(y.jsx)("br",{}),Object(y.jsx)("span",{className:"fw-bold",children:"Due Date:"})," ",e.dueDate]})]})}),Object(y.jsxs)("td",{children:[e.currencysymbol," ",e.totalamount||0]}),Object(y.jsx)("td",{children:v()(e.billingstart,"x").format("MMM DD, Y")}),Object(y.jsx)("td",{children:v()(e.billingstart,"x").add(5,"d").format("MMM DD, Y")}),Object(y.jsx)("td",{children:Object(y.jsx)(p.B,{className:"cursor-pointer",onClick:function(){D(e)},children:Object(y.jsx)(f.a,{size:17,className:"mx-1"})})})]},t);var c}))})]})})]})})})},k=c(52),D=c(193),z=c(19),S=c(16),F=Object(z.d)(),M=function(e){var t=e.planpackage,c=e.refreshFlag,i=Object(a.useState)(!1),j=Object(n.a)(i,2),d=j[0],b=j[1],u=Object(a.useContext)(k.a),h=Object(S.b)(),O=function(){return Object(y.jsx)(a.Fragment,{children:Object(y.jsx)(o.a,{})})};Object(a.useEffect)((function(){var e=document.createElement("script");e.setAttribute("src","https://checkout.razorpay.com/v1/checkout.js"),document.head.appendChild(e)}),[]);var x=function(){var e=Object(r.a)(Object(s.a)().mark((function e(){var t,c,n,a;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={id:F},e.next=3,m.a.post("organizationusers/get",t);case 3:return c=e.sent,n=c.data.organizationuser,a=[],n.ability.forEach((function(e){var t={action:e.substring(e.lastIndexOf("-")+1),subject:e.replace(e.substring(e.lastIndexOf("-")),"")};a.push(t)})),localStorage.setItem("ability",JSON.stringify(a)),e.next=10,u.update(a);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(e){var t={key:"rzp_live_54bLvIArSIcuEr",currency:"INR",amount:e.amount,order_id:e.id,name:"Turia Books",description:"",image:"./logo_full.png",handler:function(e){!function(e){b(!0),m.a.post("/billings/successpayment",e).then((function(){b(!1),c(!0),h(Object(D.e)(!1)),x()})).catch((function(){}))}(e)},theme:{color:"#0072CE"}};new window.Razorpay(t).open()};return Object(y.jsx)(a.Fragment,{children:Object(y.jsx)(l.a,{blocking:d,loader:Object(y.jsx)(O,{}),children:Object(y.jsxs)(p.l,{children:[Object(y.jsx)(p.p,{className:"border-bottom",children:Object(y.jsx)(p.v,{tag:"h4",children:"Payment Methods"})}),Object(y.jsx)(p.m,{className:"my-1 py-25",children:Object(y.jsxs)(p.ib,{className:"gx-4",children:[Object(y.jsxs)(p.B,{children:[null!==t&&!(null!==t&&void 0!==t&&t.paymentFlag)&&Object(y.jsxs)("p",{className:"text-primary",children:["Total Amount - ",t.amount]}),!(null!==t&&void 0!==t&&t.paymentFlag)&&Object(y.jsx)(p.i,{color:"primary",className:"me-1",outline:!0,onClick:function(){b(!0),m.a.post("/billings/createorder").then((function(e){b(!1),f(e.data.order)})).catch((function(){}))},children:"Pay Now"}),Object(y.jsx)(p.i,{color:"secondary",outline:!0,disabled:!0,children:"Auto Renewal"})]}),Object(y.jsx)(p.B,{lg:"6"})]})})]})})})},B=c(184),C=c.n(B),E=c(185),T=c.n(E),I=(c(787),c(850),T()(C.a),function(e){var t=e.refreshBilling,c=Object(a.useState)([]),i=Object(n.a)(c,2),l=i[0],o=i[1],j=Object(a.useState)(0),d=Object(n.a)(j,2),b=d[0],u=d[1],h=Object(a.useState)(null),O=Object(n.a)(h,2),x=O[0],f=O[1],g=Object(a.useState)(0),N=Object(n.a)(g,2),w=N[0],k=N[1],D=function(){var e=Object(r.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.a.post("/billings/planslist").then((function(e){o(e.data.plans)})).catch((function(e){console.log(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=Object(r.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.a.post("/billings/getbillingdetails").then(function(){var e=Object(r.a)(Object(s.a)().mark((function e(t){var c,n,a;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(t.data.planpackage.usercount||0),f(t.data.planpackage),c=v()().endOf("M"),n=v()(),a=c.diff(n,"days"),k(a),e.next=8,D();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)(Object(r.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z();case 2:case"end":return e.stop()}}),e)}))),[]);return Object(y.jsxs)(a.Fragment,{children:[Object(y.jsxs)(p.l,{children:[Object(y.jsx)(p.p,{className:"border-bottom",children:Object(y.jsx)(p.v,{tag:"h4",children:"Current plan"})}),Object(y.jsx)(p.m,{className:"my-2 py-25",children:Object(y.jsxs)(p.ib,{children:[Object(y.jsx)(p.B,{md:"8",children:Object(y.jsxs)(p.B,{md:12,children:[Object(y.jsxs)("h5",{className:"mb-2",children:["Total users : ",b,null!==x&&Object(y.jsxs)("p",{className:"text-primary",children:["Total Amount - ",x.usercount*x.price," + GST 18%"]})]}),Object(y.jsxs)(p.mb,{className:"table-bordered",children:[Object(y.jsx)("thead",{children:Object(y.jsxs)("tr",{children:[Object(y.jsx)("th",{children:"Select"}),Object(y.jsx)("th",{children:"Name"}),Object(y.jsx)("th",{children:"price"}),Object(y.jsx)("th",{children:"description"})]})}),Object(y.jsx)("tbody",{children:l.length>0&&l.map((function(e,t){return Object(y.jsxs)("tr",{children:[Object(y.jsx)("td",{children:Object(y.jsx)(p.K,{type:"radio",value:e.id,name:"plan",defaultChecked:(null===x||void 0===x?void 0:x.planid)===e.id})}),Object(y.jsx)("td",{children:e.name}),Object(y.jsx)("td",{children:e.price}),Object(y.jsx)("td",{children:e.description})]},t)}))})]})]})}),null!==x&&Object(y.jsx)(p.B,{md:"4",children:Object(y.jsxs)("div",{className:"plan-statistics pt-1",children:[Object(y.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(y.jsx)("h5",{className:"fw-bolder",children:"Days"}),Object(y.jsxs)("h5",{className:"fw-bolder",children:[v()().format("DD")," of ",v()().daysInMonth()," Days"]})]}),Object(y.jsx)(p.hb,{className:"mb-50",value:100-w/v()().daysInMonth()*100}),x.paymentFlag&&!x.trialflag&&Object(y.jsxs)("p",{className:"mt-50",children:[" ",w," days remaining to next billing cycle."]}),!(null!==x&&void 0!==x&&x.paymentFlag)&&!x.trialflag&&Object(y.jsx)("p",{children:"Please pay now to use all features. "}),x.trialflag&&Object(y.jsxs)("p",{className:"mt-50",children:["You are on Trial Period, Trial will Expire ",v()(x.enddate,"x").format("MMM DD, Y")]})]})})]})})]}),Object(y.jsx)(M,{planpackage:x,refreshFlag:function(e){t(e),z()}})]})});t.default=function(){var e=Object(a.useState)(!1),t=Object(n.a)(e,2),c=t[0],s=t[1];return Object(y.jsxs)(a.Fragment,{children:[Object(y.jsx)(I,{refreshBilling:function(e){return s(e)}}),Object(y.jsx)(w,{refreshHistory:c})]})}},701:function(e,t,c){"use strict";var n=c(8),a=c(23),s=c(0),r=c(7),i=c.n(r),l=c(13),o=(c(703),c(2)),j=function(e){var t,c=e.children,r=e.blocking,l=e.loader,j=e.className,d=e.tag,b=e.overlayColor,u=d;return Object(o.jsxs)(u,{className:i()("ui-loader",(t={},Object(a.a)(t,j,j),Object(a.a)(t,"show",r),t)),children:[c,r?Object(o.jsxs)(s.Fragment,{children:[Object(o.jsx)("div",Object(n.a)({className:"overlay"},r&&b?{style:{backgroundColor:b}}:{})),Object(o.jsx)("div",{className:"loader",children:l})]}):null]})};t.a=j,j.defaultProps={tag:"div",blocking:!1,loader:Object(o.jsx)(l.jb,{color:"primary"})}},702:function(e,t,c){"use strict";var n=c(2);t.a=function(){return Object(n.jsx)("div",{className:"fallback-spinner",children:Object(n.jsxs)("div",{className:"loading",children:[Object(n.jsx)("div",{className:"effect-1 effects"}),Object(n.jsx)("div",{className:"effect-2 effects"}),Object(n.jsx)("div",{className:"effect-3 effects"})]})})}},703:function(e,t,c){},717:function(e,t,c){},746:function(e,t,c){},787:function(e,t,c){},850:function(e,t,c){}}]);
//# sourceMappingURL=31.96c9b38c.chunk.js.map